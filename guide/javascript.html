<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>JavaScript / TypeScript guide | Hyperledger Iroha 2 Tutorial</title>
    <meta name="description" content="Documented tutorial for Hyperledger Iroha 2 outlining the main differences between Iroha versions along with a walkthrough and additional resources.">
    <link rel="stylesheet" href="/iroha-2-docs/assets/style.34fbf971.css">
    <link rel="modulepreload" href="/iroha-2-docs/assets/app.5cbb4beb.js">
    <link rel="modulepreload" href="/iroha-2-docs/assets/guide_javascript.md.aca015ee.lean.js">
    
    <meta name="twitter:title" content="JavaScript / TypeScript guide | Hyperledger Iroha 2 Tutorial">
  <meta property="og:title" content="JavaScript / TypeScript guide | Hyperledger Iroha 2 Tutorial">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme"><header class="nav-bar" data-v-2170b094><div class="sidebar-button" data-v-2170b094><svg class="icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z" class></path></svg></div><a class="nav-bar-title" href="/iroha-2-docs/" aria-label="Hyperledger Iroha 2 Tutorial, back to home" data-v-2170b094 data-v-d97bc718><img class="logo" src="/iroha-2-docs/logo.svg" alt="Logo" data-v-d97bc718> Hyperledger Iroha 2 Tutorial</a><div class="flex-grow" data-v-2170b094></div><div class="nav" data-v-2170b094><nav class="nav-links" data-v-2170b094 data-v-2b096b62><!--[--><div class="item" data-v-2b096b62><div class="nav-link" data-v-2b096b62 data-v-452f0eb9><a class="item active" href="/iroha-2-docs/" data-v-452f0eb9>Guide <!----></a></div></div><!--]--><!----><div class="item" data-v-2b096b62><div class="nav-link" data-v-2b096b62 data-v-452f0eb9><a class="item isExternal" href="https://github.com/hyperledger/iroha-2-docs" target="_blank" rel="noopener noreferrer" data-v-452f0eb9>GitHub <svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-452f0eb9><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div></nav></div><!--[--><!--]--></header><aside class="sidebar" data-v-44509ecb><nav class="nav-links nav" data-v-44509ecb data-v-2b096b62><!--[--><div class="item" data-v-2b096b62><div class="nav-link" data-v-2b096b62 data-v-452f0eb9><a class="item active" href="/iroha-2-docs/" data-v-452f0eb9>Guide <!----></a></div></div><!--]--><!----><div class="item" data-v-2b096b62><div class="nav-link" data-v-2b096b62 data-v-452f0eb9><a class="item isExternal" href="https://github.com/hyperledger/iroha-2-docs" target="_blank" rel="noopener noreferrer" data-v-452f0eb9>GitHub <svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-452f0eb9><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div></nav><!--[--><!--]--><ul class="sidebar-links" data-v-44509ecb><!--[--><li class="sidebar-link"><p class="sidebar-link-item">Getting started</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/iroha-2-docs/">Introduction</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/iroha-2-docs/guide/build-and-install">Build and Install</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">Language-specific guides</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/iroha-2-docs/guide/bash">Bash</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/iroha-2-docs/guide/python">Python 3</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/iroha-2-docs/guide/rust">Rust</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/iroha-2-docs/guide/kotlin-java">Kotlin/Java</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item active" href="/iroha-2-docs/guide/javascript">JavaScript</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="#_1-iroha-2-client-setup">1. Iroha 2 Client Setup</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#_2-configuring-iroha-2">2. Configuring Iroha 2</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#_3-registering-a-domain">3. Registering a Domain</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#_4-registering-an-account">4. Registering an Account</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#_5-registering-and-minting-assets">5. Registering and minting assets</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#_6-visualizing-outputs">6. Visualizing outputs</a><!----></li></ul></li></ul></li><li class="sidebar-link"><a class="sidebar-link-item" href="/iroha-2-docs/guide/conclusions">Conclusions</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/iroha-2-docs/guide/appendix/intro">Appendix</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/iroha-2-docs/guide/appendix/peer-configuration">Peer Configuration</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/iroha-2-docs/guide/appendix/trusted-peers">Trusted Peers</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/iroha-2-docs/guide/appendix/kura">Kura</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/iroha-2-docs/guide/appendix/public-addresses">Iroha Public Addresses</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/iroha-2-docs/guide/appendix/logger">Logger</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/iroha-2-docs/guide/appendix/genesis">Genesis Block</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/iroha-2-docs/guide/appendix/client-configuration">Client Configuration</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/iroha-2-docs/guide/appendix/running-iroha-on-bare-metal">Running Iroha On Bare Metal</a><!----></li></ul></li><!--]--></ul><!--[--><!--]--></aside><div class="sidebar-mask"></div><main class="page" data-v-5ab2b583><div class="container" data-v-5ab2b583><!--[--><!--]--><div style="position:relative;" class="content" data-v-5ab2b583><div><h1 id="javascript-typescript-guide" tabindex="-1">JavaScript / TypeScript guide <a class="header-anchor" href="#javascript-typescript-guide" aria-hidden="true">#</a></h1><h2 id="_1-iroha-2-client-setup" tabindex="-1">1. Iroha 2 Client Setup <a class="header-anchor" href="#_1-iroha-2-client-setup" aria-hidden="true">#</a></h2><p>The Iroha 2 JavaScript library consists of multiple packages:</p><table><thead><tr><th>Package</th><th>Description</th></tr></thead><tbody><tr><td><code>client</code></td><td>Submits requests to Iroha Peer</td></tr><tr><td><code>data-model</code></td><td>Provides <a href="https://github.com/paritytech/parity-scale-codec" target="_blank" rel="noopener noreferrer">SCALE</a> (Simple Concatenated Aggregate Little-Endian)-codecs for the Iroha 2 Data Model</td></tr><tr><td><code>crypto-core</code></td><td>Contains cryptography types</td></tr><tr><td><code>crypto-target-node</code></td><td>Compiled crypto WASM (<a href="https://webassembly.org/" target="_blank" rel="noopener noreferrer">Web Assembly</a>) for the Node.js environment</td></tr><tr><td><code>crypto-target-web</code></td><td>Compiled crypto WASM for native Web (ESM)</td></tr><tr><td><code class="whitespace-pre">crypto-target-bundler</code></td><td>Compiled crypto WASM to use with bundlers such as Webpack</td></tr></tbody></table><p>All of the are published under scope <code>@iroha2</code> into Iroha Nexus Registry. In future, they will be published in the main NPM Registry. To install these packages, firstly you need to setup a registry:</p><div class="language-ini"><pre class="shiki shiki-light" style="background-color:#ffffff;"><code><span class="line"><span style="color:#6E7781;"># .npmrc</span></span>
<span class="line"><span style="color:#24292F;">@iroha2:</span><span style="color:#CF222E;">registry</span><span style="color:#24292F;">=https://nexus.iroha.tech/repository/npm-group/</span></span>
<span class="line"></span></code></pre></div><p>Then you can install these packages as any other NPM package:</p><div class="language-bash"><pre class="shiki shiki-light" style="background-color:#ffffff;"><code><span class="line"><span style="color:#24292F;">npm i @iroha2/client</span></span>
<span class="line"><span style="color:#24292F;">yarn add @iroha2/data-model</span></span>
<span class="line"><span style="color:#24292F;">pnpm add @iroha2/crypto-target-web</span></span>
<span class="line"></span></code></pre></div><p>The set of packages that you need to install depends on your intention. Maybe you only need to play with the Data Model to perform (de-)serialisation, in which case the <code>data-model</code> package is enough. Maybe you only need to check on a peer in terms of status/health, thus need only the client library, because this API doesn&#39;t require any interactions with crypto or Data Model. For the purposes of this tutorial, it’s better to install everything, however, in general the packages are maximally decoupled, so you can minimise the footprint.</p><p>Moving on, if you are planning to use the Transaction or Query API, you’ll also need to inject an appropriate <code>crypto</code> instance into the client at runtime. This has to be adjusted depending on your particular environment. For example, for Node.js users, such an injection may look like the following:</p><div class="language-ts"><pre class="shiki shiki-light" style="background-color:#ffffff;"><code><span class="line"><span style="color:#CF222E;">import</span><span style="color:#24292F;"> { crypto } </span><span style="color:#CF222E;">from</span><span style="color:#24292F;"> </span><span style="color:#0A3069;">`@iroha2/crypto-target-node`</span></span>
<span class="line"><span style="color:#CF222E;">import</span><span style="color:#24292F;"> { setCrypto } </span><span style="color:#CF222E;">from</span><span style="color:#24292F;"> </span><span style="color:#0A3069;">`@iroha2/client`</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8250DF;">setCrypto</span><span style="color:#24292F;">(crypto)</span></span>
<span class="line"></span></code></pre></div><div class="info custom-block"><p class="custom-block-title">INFO</p><p>Please refer to the related <code>@iroha2/crypto-target-*</code> package documentation because it may require some specific configuration. For example, the <code>web</code> target requires to call an asynchronous <code>init()</code> function before usage of <code>crypto</code>.</p></div><h2 id="_2-configuring-iroha-2" tabindex="-1">2. Configuring Iroha 2 <a class="header-anchor" href="#_2-configuring-iroha-2" aria-hidden="true">#</a></h2><p>The JavaScript Client is fairly low-level in the sense that it doesn’t expose any convenience features like a <code>TransactionBuilder</code> or a <code>ConfigBuilder</code>. Work on implementing those is underway, and these features will very likely be available with the second round of this tutorial’s release. Thus, on the plus side: configuration of the client is simple, on the negative side you have to prepare a lot is done manually.</p><p>A basic client setup looks straightforward:</p><div class="language-ts"><pre class="shiki shiki-light" style="background-color:#ffffff;"><code><span class="line"><span style="color:#CF222E;">import</span><span style="color:#24292F;"> { Client } </span><span style="color:#CF222E;">from</span><span style="color:#24292F;"> </span><span style="color:#0A3069;">&#39;@iroha2/client&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CF222E;">const</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">client</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> Client.</span><span style="color:#8250DF;">create</span><span style="color:#24292F;">({</span></span>
<span class="line"><span style="color:#24292F;">  torii: {</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#6E7781;">// specify it if you want to use Transactions API,</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#6E7781;">// Query API, Events API or health check</span></span>
<span class="line"><span style="color:#24292F;">    apiURL: </span><span style="color:#0A3069;">&#39;http://127.0.0.1:8080&#39;</span><span style="color:#24292F;">,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#6E7781;">// specify it if you want to perform status check</span></span>
<span class="line"><span style="color:#24292F;">    statusURL: </span><span style="color:#0A3069;">&#39;http://127.0.0.1:8081&#39;</span><span style="color:#24292F;">,</span></span>
<span class="line"><span style="color:#24292F;">  },</span></span>
<span class="line"><span style="color:#24292F;">})</span></span>
<span class="line"></span></code></pre></div><p>That&#39;s enough to perform health or status check, but if you need to use transactions or queries, you’ll need to prepare a key pair.</p><p>Let&#39;s assume that you have stringified public &amp; private keys, more on that later. Thus, a key-pair generation could look like this:</p><div class="language-ts"><pre class="shiki shiki-light" style="background-color:#ffffff;"><code><span class="line"><span style="color:#CF222E;">import</span><span style="color:#24292F;"> { crypto } </span><span style="color:#CF222E;">from</span><span style="color:#24292F;"> </span><span style="color:#0A3069;">&#39;@iroha2/crypto-target-node&#39;</span></span>
<span class="line"><span style="color:#CF222E;">import</span><span style="color:#24292F;"> { KeyPair } </span><span style="color:#CF222E;">from</span><span style="color:#24292F;"> </span><span style="color:#0A3069;">&#39;@iroha2/crypto-core&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6E7781;">// just some package for hex-bytes transform</span></span>
<span class="line"><span style="color:#CF222E;">import</span><span style="color:#24292F;"> { hexToBytes } </span><span style="color:#CF222E;">from</span><span style="color:#24292F;"> </span><span style="color:#0A3069;">&#39;hada&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CF222E;">function</span><span style="color:#24292F;"> </span><span style="color:#8250DF;">generateKeyPair</span><span style="color:#24292F;">(</span><span style="color:#953800;">params</span><span style="color:#CF222E;">:</span><span style="color:#24292F;"> {</span></span>
<span class="line"><span style="color:#24292F;">  </span><span style="color:#953800;">publicKeyMultihash</span><span style="color:#CF222E;">:</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">string</span></span>
<span class="line"><span style="color:#24292F;">  </span><span style="color:#953800;">privateKey</span><span style="color:#CF222E;">:</span><span style="color:#24292F;"> {</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#953800;">digestFunction</span><span style="color:#CF222E;">:</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">string</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#953800;">payload</span><span style="color:#CF222E;">:</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">string</span></span>
<span class="line"><span style="color:#24292F;">  }</span></span>
<span class="line"><span style="color:#24292F;">})</span><span style="color:#CF222E;">:</span><span style="color:#24292F;"> </span><span style="color:#953800;">KeyPair</span><span style="color:#24292F;"> {</span></span>
<span class="line"><span style="color:#24292F;">  </span><span style="color:#CF222E;">const</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">multihashBytes</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">Uint8Array</span><span style="color:#24292F;">.</span><span style="color:#8250DF;">from</span><span style="color:#24292F;">(</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#8250DF;">hexToBytes</span><span style="color:#24292F;">(params.publicKeyMultihash),</span></span>
<span class="line"><span style="color:#24292F;">  )</span></span>
<span class="line"><span style="color:#24292F;">  </span><span style="color:#CF222E;">const</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">multihash</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> crypto.</span><span style="color:#8250DF;">createMultihashFromBytes</span><span style="color:#24292F;">(multihashBytes)</span></span>
<span class="line"><span style="color:#24292F;">  </span><span style="color:#CF222E;">const</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">publicKey</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> crypto.</span><span style="color:#8250DF;">createPublicKeyFromMultihash</span><span style="color:#24292F;">(multihash)</span></span>
<span class="line"><span style="color:#24292F;">  </span><span style="color:#CF222E;">const</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">privateKey</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> crypto.</span><span style="color:#8250DF;">createPrivateKeyFromJsKey</span><span style="color:#24292F;">(params.privateKey)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292F;">  </span><span style="color:#CF222E;">const</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">keyPair</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> crypto.</span><span style="color:#8250DF;">createKeyPairFromKeys</span><span style="color:#24292F;">(publicKey, privateKey)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292F;">  </span><span style="color:#6E7781;">// don&#39;t forget to &quot;free&quot; created structures</span></span>
<span class="line"><span style="color:#24292F;">  </span><span style="color:#CF222E;">for</span><span style="color:#24292F;"> (</span><span style="color:#CF222E;">const</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">x</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">of</span><span style="color:#24292F;"> [publicKey, privateKey, multihash]) {</span></span>
<span class="line"><span style="color:#24292F;">    x.</span><span style="color:#8250DF;">free</span><span style="color:#24292F;">()</span></span>
<span class="line"><span style="color:#24292F;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292F;">  </span><span style="color:#CF222E;">return</span><span style="color:#24292F;"> keyPair</span></span>
<span class="line"><span style="color:#24292F;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CF222E;">const</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">kp</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> </span><span style="color:#8250DF;">generateKeyPair</span><span style="color:#24292F;">({</span></span>
<span class="line"><span style="color:#24292F;">  publicKeyMultihash:</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#0A3069;">&#39;ed0120e555d194e8822da35ac541ce9eec8b45058f4d294d9426ef97ba92698766f7d3&#39;</span><span style="color:#24292F;">,</span></span>
<span class="line"><span style="color:#24292F;">  privateKey: {</span></span>
<span class="line"><span style="color:#24292F;">    digestFunction: </span><span style="color:#0A3069;">&#39;ed25519&#39;</span><span style="color:#24292F;">,</span></span>
<span class="line"><span style="color:#24292F;">    payload:</span></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#0A3069;">&#39;de757bcb79f4c63e8fa0795edc26f86dfdba189b846e903d0b732bb644607720e555d194e8822da35ac541ce9eec8b45058f4d294d9426ef97ba92698766f7d3&#39;</span><span style="color:#24292F;">,</span></span>
<span class="line"><span style="color:#24292F;">  },</span></span>
<span class="line"><span style="color:#24292F;">})</span></span>
<span class="line"></span></code></pre></div><h2 id="_3-registering-a-domain" tabindex="-1">3. Registering a Domain <a class="header-anchor" href="#_3-registering-a-domain" aria-hidden="true">#</a></h2><p>Here we see how similar the JavaScript code is to the Rust counterpart. It should be emphasised that the JavaScript library is a thin wrapper: It doesn’t provide any special builder structures, meaning you have to work with bare-bones compiled Data Model structures and define all internal fields explicitly. Doubly so, since JavaScript employs many implicit conversions, we highly recommend that you employ typescript. This makes many errors far easier to debug, but unfortunately results in more boiler-plate.</p><p>Let’s register a new domain with the name <code>looking_glass</code> our current account: <em>alice@wondeland</em>.</p><div class="language-ts"><pre class="shiki shiki-light" style="background-color:#ffffff;"><code><span class="line"><span style="color:#CF222E;">import</span><span style="color:#24292F;"> { Client } </span><span style="color:#CF222E;">from</span><span style="color:#24292F;"> </span><span style="color:#0A3069;">&#39;@iroha2/client&#39;</span></span>
<span class="line"><span style="color:#CF222E;">import</span><span style="color:#24292F;"> { KeyPair } </span><span style="color:#CF222E;">from</span><span style="color:#24292F;"> </span><span style="color:#0A3069;">&#39;@iroha2/crypto-core&#39;</span></span>
<span class="line"><span style="color:#CF222E;">import</span><span style="color:#24292F;"> {</span></span>
<span class="line"><span style="color:#24292F;">  AccountId,</span></span>
<span class="line"><span style="color:#24292F;">  Expression,</span></span>
<span class="line"><span style="color:#24292F;">  IdentifiableBox,</span></span>
<span class="line"><span style="color:#24292F;">  Instruction,</span></span>
<span class="line"><span style="color:#24292F;">  OptionU32,</span></span>
<span class="line"><span style="color:#24292F;">  QueryBox,</span></span>
<span class="line"><span style="color:#24292F;">  QueryPayload,</span></span>
<span class="line"><span style="color:#24292F;">  RegisterBox,</span></span>
<span class="line"><span style="color:#24292F;">  TransactionPayload,</span></span>
<span class="line"><span style="color:#24292F;">  Value,</span></span>
<span class="line"><span style="color:#24292F;">} </span><span style="color:#CF222E;">from</span><span style="color:#24292F;"> </span><span style="color:#0A3069;">&#39;@iroha2/data-model&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CF222E;">const</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">client</span><span style="color:#CF222E;">:</span><span style="color:#24292F;"> </span><span style="color:#953800;">Client</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> </span><span style="color:#6E7781;">/* snip */</span><span style="color:#24292F;"> ___</span></span>
<span class="line"><span style="color:#CF222E;">const</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">KEY_PAIR</span><span style="color:#CF222E;">:</span><span style="color:#24292F;"> </span><span style="color:#953800;">KeyPair</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> </span><span style="color:#6E7781;">/* snip */</span><span style="color:#24292F;"> ___</span></span>
<span class="line"><span style="color:#CF222E;">const</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">ACCOUNT_ID</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> AccountId.</span><span style="color:#8250DF;">defineUnwrap</span><span style="color:#24292F;">({</span></span>
<span class="line"><span style="color:#24292F;">  name: </span><span style="color:#0A3069;">&#39;Alice&#39;</span><span style="color:#24292F;">,</span></span>
<span class="line"><span style="color:#24292F;">  domain_name: </span><span style="color:#0A3069;">&#39;Wonderland&#39;</span><span style="color:#24292F;">,</span></span>
<span class="line"><span style="color:#24292F;">})</span></span>
<span class="line"></span></code></pre></div><p>To register a new domain, we need to submit a transaction with one instruction: to register a new domain. Let’s wrap it all in an async function:</p><div class="language-ts"><pre class="shiki shiki-light" style="background-color:#ffffff;"><code><span class="line"><span style="color:#CF222E;">async</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">function</span><span style="color:#24292F;"> </span><span style="color:#8250DF;">registerDomain</span><span style="color:#24292F;">(</span><span style="color:#953800;">domainName</span><span style="color:#CF222E;">:</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">string</span><span style="color:#24292F;">) {</span></span>
<span class="line"><span style="color:#24292F;">  </span><span style="color:#CF222E;">const</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">registerBox</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> RegisterBox.</span><span style="color:#8250DF;">defineUnwrap</span><span style="color:#24292F;">({</span></span>
<span class="line"><span style="color:#24292F;">    object: {</span></span>
<span class="line"><span style="color:#24292F;">      expression: Expression.variantsUnwrapped.</span><span style="color:#8250DF;">Raw</span><span style="color:#24292F;">(</span></span>
<span class="line"><span style="color:#24292F;">        Value.variantsUnwrapped.</span><span style="color:#8250DF;">Identifiable</span><span style="color:#24292F;">(</span></span>
<span class="line"><span style="color:#24292F;">          IdentifiableBox.variantsUnwrapped.</span><span style="color:#8250DF;">Domain</span><span style="color:#24292F;">({</span></span>
<span class="line"><span style="color:#24292F;">            name: domainName,</span></span>
<span class="line"><span style="color:#24292F;">            accounts: </span><span style="color:#CF222E;">new</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">Map</span><span style="color:#24292F;">(),</span></span>
<span class="line"><span style="color:#24292F;">            metadata: {</span></span>
<span class="line"><span style="color:#24292F;">              map: </span><span style="color:#CF222E;">new</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">Map</span><span style="color:#24292F;">(),</span></span>
<span class="line"><span style="color:#24292F;">            },</span></span>
<span class="line"><span style="color:#24292F;">            asset_definitions: </span><span style="color:#CF222E;">new</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">Map</span><span style="color:#24292F;">(),</span></span>
<span class="line"><span style="color:#24292F;">          }),</span></span>
<span class="line"><span style="color:#24292F;">        ),</span></span>
<span class="line"><span style="color:#24292F;">      ),</span></span>
<span class="line"><span style="color:#24292F;">    },</span></span>
<span class="line"><span style="color:#24292F;">  })</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292F;">  </span><span style="color:#CF222E;">const</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">instruction</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> Instruction.variantsUnwrapped.</span><span style="color:#8250DF;">Register</span><span style="color:#24292F;">(registerBox)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292F;">  </span><span style="color:#CF222E;">const</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">payload</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> TransactionPayload.</span><span style="color:#8250DF;">defineUnwrap</span><span style="color:#24292F;">({</span></span>
<span class="line"><span style="color:#24292F;">    account_id: </span><span style="color:#0550AE;">ACCOUNT_ID</span><span style="color:#24292F;">,</span></span>
<span class="line"><span style="color:#24292F;">    instructions: [instruction],</span></span>
<span class="line"><span style="color:#24292F;">    time_to_live_ms: </span><span style="color:#0550AE;">100_000</span><span style="color:#CF222E;">n</span><span style="color:#24292F;">,</span></span>
<span class="line"><span style="color:#24292F;">    creation_time: </span><span style="color:#0550AE;">BigInt</span><span style="color:#24292F;">(</span><span style="color:#0550AE;">Date</span><span style="color:#24292F;">.</span><span style="color:#8250DF;">now</span><span style="color:#24292F;">()),</span></span>
<span class="line"><span style="color:#24292F;">    metadata: </span><span style="color:#CF222E;">new</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">Map</span><span style="color:#24292F;">(),</span></span>
<span class="line"><span style="color:#24292F;">    nonce: OptionU32.variantsUnwrapped.None,</span></span>
<span class="line"><span style="color:#24292F;">  })</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292F;">  </span><span style="color:#CF222E;">await</span><span style="color:#24292F;"> client.</span><span style="color:#8250DF;">submitTransaction</span><span style="color:#24292F;">({</span></span>
<span class="line"><span style="color:#24292F;">    payload: TransactionPayload.</span><span style="color:#8250DF;">wrap</span><span style="color:#24292F;">(payload),</span></span>
<span class="line"><span style="color:#24292F;">    signing: </span><span style="color:#0550AE;">KEY_PAIR</span><span style="color:#24292F;">,</span></span>
<span class="line"><span style="color:#24292F;">  })</span></span>
<span class="line"><span style="color:#24292F;">}</span></span>
<span class="line"></span></code></pre></div><p>Which we use to register the domain like so:</p><div class="language-ts"><pre class="shiki shiki-light" style="background-color:#ffffff;"><code><span class="line"><span style="color:#CF222E;">await</span><span style="color:#24292F;"> </span><span style="color:#8250DF;">registerDomain</span><span style="color:#24292F;">(</span><span style="color:#0A3069;">&#39;looking_glass&#39;</span><span style="color:#24292F;">)</span></span>
<span class="line"></span></code></pre></div><p>We can also ensure that new domain is created using Query API. Let’s create another function that wraps that functionality:</p><div class="language-ts"><pre class="shiki shiki-light" style="background-color:#ffffff;"><code><span class="line"><span style="color:#CF222E;">async</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">function</span><span style="color:#24292F;"> </span><span style="color:#8250DF;">ensureDomainExistence</span><span style="color:#24292F;">(</span><span style="color:#953800;">domainName</span><span style="color:#CF222E;">:</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">string</span><span style="color:#24292F;">) {</span></span>
<span class="line"><span style="color:#24292F;">  </span><span style="color:#CF222E;">const</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">result</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">await</span><span style="color:#24292F;"> client.</span><span style="color:#8250DF;">makeQuery</span><span style="color:#24292F;">({</span></span>
<span class="line"><span style="color:#24292F;">    payload: QueryPayload.</span><span style="color:#8250DF;">wrap</span><span style="color:#24292F;">({</span></span>
<span class="line"><span style="color:#24292F;">      query: QueryBox.variantsUnwrapped.</span><span style="color:#8250DF;">FindAllDomains</span><span style="color:#24292F;">(</span><span style="color:#0550AE;">null</span><span style="color:#24292F;">),</span></span>
<span class="line"><span style="color:#24292F;">      timestamp_ms: </span><span style="color:#0550AE;">BigInt</span><span style="color:#24292F;">(</span><span style="color:#0550AE;">Date</span><span style="color:#24292F;">.</span><span style="color:#8250DF;">now</span><span style="color:#24292F;">()),</span></span>
<span class="line"><span style="color:#24292F;">      account_id: </span><span style="color:#0550AE;">ACCOUNT_ID</span><span style="color:#24292F;">,</span></span>
<span class="line"><span style="color:#24292F;">    }),</span></span>
<span class="line"><span style="color:#24292F;">    signing: </span><span style="color:#0550AE;">KEY_PAIR</span><span style="color:#24292F;">,</span></span>
<span class="line"><span style="color:#24292F;">  })</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292F;">  </span><span style="color:#CF222E;">const</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">domain</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> result</span></span>
<span class="line"><span style="color:#24292F;">    .</span><span style="color:#8250DF;">as</span><span style="color:#24292F;">(</span><span style="color:#0A3069;">&#39;Ok&#39;</span><span style="color:#24292F;">)</span></span>
<span class="line"><span style="color:#24292F;">    .</span><span style="color:#8250DF;">unwrap</span><span style="color:#24292F;">()</span></span>
<span class="line"><span style="color:#24292F;">    .</span><span style="color:#8250DF;">as</span><span style="color:#24292F;">(</span><span style="color:#0A3069;">&#39;Vec&#39;</span><span style="color:#24292F;">)</span></span>
<span class="line"><span style="color:#24292F;">    .</span><span style="color:#8250DF;">map</span><span style="color:#24292F;">((</span><span style="color:#953800;">x</span><span style="color:#24292F;">) </span><span style="color:#CF222E;">=&gt;</span><span style="color:#24292F;"> x.</span><span style="color:#8250DF;">as</span><span style="color:#24292F;">(</span><span style="color:#0A3069;">&#39;Identifiable&#39;</span><span style="color:#24292F;">).</span><span style="color:#8250DF;">as</span><span style="color:#24292F;">(</span><span style="color:#0A3069;">&#39;Domain&#39;</span><span style="color:#24292F;">))</span></span>
<span class="line"><span style="color:#24292F;">    .</span><span style="color:#8250DF;">find</span><span style="color:#24292F;">((</span><span style="color:#953800;">x</span><span style="color:#24292F;">) </span><span style="color:#CF222E;">=&gt;</span><span style="color:#24292F;"> x.name </span><span style="color:#CF222E;">===</span><span style="color:#24292F;"> domainName)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292F;">  </span><span style="color:#CF222E;">if</span><span style="color:#24292F;"> (</span><span style="color:#CF222E;">!</span><span style="color:#24292F;">domain) </span><span style="color:#CF222E;">throw</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">new</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">Error</span><span style="color:#24292F;">(</span><span style="color:#0A3069;">&#39;Not found&#39;</span><span style="color:#24292F;">)</span></span>
<span class="line"><span style="color:#24292F;">}</span></span>
<span class="line"></span></code></pre></div><p>Now you can ensure that domain is created by calling:</p><div class="language-ts"><pre class="shiki shiki-light" style="background-color:#ffffff;"><code><span class="line"><span style="color:#CF222E;">await</span><span style="color:#24292F;"> </span><span style="color:#8250DF;">ensureDomainExistence</span><span style="color:#24292F;">(</span><span style="color:#0A3069;">&#39;looking_glass&#39;</span><span style="color:#24292F;">)</span></span>
<span class="line"></span></code></pre></div><h2 id="_4-registering-an-account" tabindex="-1">4. Registering an Account <a class="header-anchor" href="#_4-registering-an-account" aria-hidden="true">#</a></h2><p>Registering an account is a bit more involved than registering a domain. With a domain, the only concern is the domain name, however, with an account, there are a few more things to worry about.</p><p>First of all, we need to create an <code>AccountId</code>. Note, that we can only register an account to an existing domain. The best UX design practices dictate that you should check if the requested domain exists <em>now</em>, and if it doesn’t — suggest a fix to the user. After that, we can create a new account, that we name <em>late_bunny.</em></p><div class="language-ts"><pre class="shiki shiki-light" style="background-color:#ffffff;"><code><span class="line"><span style="color:#CF222E;">import</span><span style="color:#24292F;"> { AccountId } </span><span style="color:#CF222E;">from</span><span style="color:#24292F;"> </span><span style="color:#0A3069;">&#39;@iroha2/data-model&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CF222E;">const</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">id</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> AccountId.</span><span style="color:#8250DF;">defineUnwrap</span><span style="color:#24292F;">({</span></span>
<span class="line"><span style="color:#24292F;">  name: </span><span style="color:#0A3069;">&#39;late_bunny&#39;</span><span style="color:#24292F;">,</span></span>
<span class="line"><span style="color:#24292F;">  domain_name: </span><span style="color:#0A3069;">&#39;looking_glass&#39;</span><span style="color:#24292F;">,</span></span>
<span class="line"><span style="color:#24292F;">})</span></span>
<span class="line"></span></code></pre></div><p>Second, you should provide the account with a public key. It is tempting to generate both it and the private key at this time, but it isn&#39;t the brightest idea. Remember, that <em>the late_bunny</em> trusts <em>you, alice@wonderland,</em> to create an account for them in the domain <em>looking_glass, <strong>but doesn&#39;t want you to have access to that account after creation</strong>.</em> If you gave <em>late_bunny</em> a key that you generated yourself, how would they know if you don&#39;t have a copy of their private key? Instead, the best way is to <strong>ask</strong> <em>late_bunny</em> to generate a new key-pair, and give you the public half of it.</p><div class="language-ts"><pre class="shiki shiki-light" style="background-color:#ffffff;"><code><span class="line"><span style="color:#CF222E;">import</span><span style="color:#24292F;"> { PublicKey } </span><span style="color:#CF222E;">from</span><span style="color:#24292F;"> </span><span style="color:#0A3069;">&#39;@iroha2/data-model&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CF222E;">const</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">key</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> PublicKey.</span><span style="color:#8250DF;">defineUnwrap</span><span style="color:#24292F;">({</span></span>
<span class="line"><span style="color:#24292F;">  payload: </span><span style="color:#CF222E;">new</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">Uint8Array</span><span style="color:#24292F;">([</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#6E7781;">/* ... */</span></span>
<span class="line"><span style="color:#24292F;">  ]),</span></span>
<span class="line"><span style="color:#24292F;">  digest_function: </span><span style="color:#0A3069;">&#39;some_digest&#39;</span><span style="color:#24292F;">,</span></span>
<span class="line"><span style="color:#24292F;">})</span></span>
<span class="line"></span></code></pre></div><p>Only then do we build an instruction from it:</p><div class="language-ts"><pre class="shiki shiki-light" style="background-color:#ffffff;"><code><span class="line"><span style="color:#CF222E;">import</span><span style="color:#24292F;"> {</span></span>
<span class="line"><span style="color:#24292F;">  RegisterBox,</span></span>
<span class="line"><span style="color:#24292F;">  Expression,</span></span>
<span class="line"><span style="color:#24292F;">  Value,</span></span>
<span class="line"><span style="color:#24292F;">  IdentifiableBox,</span></span>
<span class="line"><span style="color:#24292F;">} </span><span style="color:#CF222E;">from</span><span style="color:#24292F;"> </span><span style="color:#0A3069;">&#39;@iroha2/data-model&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292F;">RegisterBox.</span><span style="color:#8250DF;">defineUnwrap</span><span style="color:#24292F;">({</span></span>
<span class="line"><span style="color:#24292F;">  object: {</span></span>
<span class="line"><span style="color:#24292F;">    expression: Expression.variantsUnwrapped.</span><span style="color:#8250DF;">Raw</span><span style="color:#24292F;">(</span></span>
<span class="line"><span style="color:#24292F;">      Value.variantsUnwrapped.</span><span style="color:#8250DF;">Identifiable</span><span style="color:#24292F;">(</span></span>
<span class="line"><span style="color:#24292F;">        IdentifiableBox.variantsUnwrapped.</span><span style="color:#8250DF;">NewAccount</span><span style="color:#24292F;">({</span></span>
<span class="line"><span style="color:#24292F;">          id,</span></span>
<span class="line"><span style="color:#24292F;">          signatories: [key],</span></span>
<span class="line"><span style="color:#24292F;">          metadata: { map: </span><span style="color:#CF222E;">new</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">Map</span><span style="color:#24292F;">() },</span></span>
<span class="line"><span style="color:#24292F;">        }),</span></span>
<span class="line"><span style="color:#24292F;">      ),</span></span>
<span class="line"><span style="color:#24292F;">    ),</span></span>
<span class="line"><span style="color:#24292F;">  },</span></span>
<span class="line"><span style="color:#24292F;">})</span></span>
<span class="line"></span></code></pre></div><p>Which is then wrapped in a transaction and submitted to the peer as in the previous section.</p><h2 id="_5-registering-and-minting-assets" tabindex="-1">5. Registering and minting assets <a class="header-anchor" href="#_5-registering-and-minting-assets" aria-hidden="true">#</a></h2><p>Now we must talk a little about assets. Iroha has been built with few underlying assumptions about what the assets need to be. The assets can be fungible (every £1 is exactly the same as every other £1), or non-fungible (a £1 bill signed by the Queen of Hearts is not the same as a £1 bill signed by the King of Spades), mintable (you can make more of them) and non-mintable (you can only specify their initial quantity in the genesis block). Additionally, the assets have different underlying value types.</p><p>Specifically, we have <code>AssetValueType::Quantity</code> which is effectively an unsigned 32-bit integer, a <code>BigQuantity</code> which is an unsigned 128 bit integer, which is enough to trade all possible IPV6 addresses, and quite possibly individual grains of sand on the surface of the earth and <code>Fixed</code>, which is a positive (though signed) 64-bit fixed-precision number with nine significant digits after the decimal point. It doesn&#39;t quite use binary-coded decimal for performance reasons. All three types can be registered as either <strong>mintable</strong> or <strong>non-mintable</strong>.</p><p>In JS, you can create a new asset with the following instruction:</p><div class="language-ts"><pre class="shiki shiki-light" style="background-color:#ffffff;"><code><span class="line"><span style="color:#CF222E;">const</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">time</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> AssetDefinition.</span><span style="color:#8250DF;">defineUnwrap</span><span style="color:#24292F;">({</span></span>
<span class="line"><span style="color:#24292F;">  value_type: AssetValueType.variantsUnwrapped.Quantity,</span></span>
<span class="line"><span style="color:#24292F;">  id: {</span></span>
<span class="line"><span style="color:#24292F;">    name: </span><span style="color:#0A3069;">&#39;time&#39;</span><span style="color:#24292F;">,</span></span>
<span class="line"><span style="color:#24292F;">    domain_name: </span><span style="color:#0A3069;">&#39;looking_glass&#39;</span><span style="color:#24292F;">,</span></span>
<span class="line"><span style="color:#24292F;">  },</span></span>
<span class="line"><span style="color:#24292F;">  metadata: { map: </span><span style="color:#CF222E;">new</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">Map</span><span style="color:#24292F;">() },</span></span>
<span class="line"><span style="color:#24292F;">  mintable: </span><span style="color:#0550AE;">false</span><span style="color:#24292F;">,</span></span>
<span class="line"><span style="color:#24292F;">})</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CF222E;">const</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">register</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> RegisterBox.</span><span style="color:#8250DF;">defineUnwrap</span><span style="color:#24292F;">({</span></span>
<span class="line"><span style="color:#24292F;">  object: {</span></span>
<span class="line"><span style="color:#24292F;">    expression: Expression.variantsUnwrapped.</span><span style="color:#8250DF;">Raw</span><span style="color:#24292F;">(</span></span>
<span class="line"><span style="color:#24292F;">      Value.variantsUnwrapped.</span><span style="color:#8250DF;">Identifiable</span><span style="color:#24292F;">(</span></span>
<span class="line"><span style="color:#24292F;">        IdentifiableBox.variantsUnwrapped.</span><span style="color:#8250DF;">AssetDefinition</span><span style="color:#24292F;">(time),</span></span>
<span class="line"><span style="color:#24292F;">      ),</span></span>
<span class="line"><span style="color:#24292F;">    ),</span></span>
<span class="line"><span style="color:#24292F;">  },</span></span>
<span class="line"><span style="color:#24292F;">})</span></span>
<span class="line"></span></code></pre></div><p>Pay attention to that we have defined the asset as <code>mintable: false</code>. What this means is that we cannot create more of <code>time</code>. The late bunny will always be late, because even the super-user of the blockchain cannot mint more of <code>time</code> than already exists in the genesis block.</p><p>This means that no matter how hard the <em>late_bunny</em> tries, the time that he has is the time that was given to him at genesis. And since we haven’t defined any time in the domain <em>looking_glass at</em> genesis and defined time in a non-mintable fashion afterwards, the <em>late_bunny</em> is doomed to always be late.</p><p>We can however mint a pre-existing <code>mintable: true</code> asset that belongs to Alice.</p><div class="language-ts"><pre class="shiki shiki-light" style="background-color:#ffffff;"><code><span class="line"><span style="color:#CF222E;">const</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">mint</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> MintBox.</span><span style="color:#8250DF;">defineUnwrap</span><span style="color:#24292F;">({</span></span>
<span class="line"><span style="color:#24292F;">  object: {</span></span>
<span class="line"><span style="color:#24292F;">    expression: Expression.variantsUnwrapped.</span><span style="color:#8250DF;">Raw</span><span style="color:#24292F;">(</span></span>
<span class="line"><span style="color:#24292F;">      Value.variantsUnwrapped.</span><span style="color:#8250DF;">U32</span><span style="color:#24292F;">(</span><span style="color:#0550AE;">42</span><span style="color:#24292F;">),</span></span>
<span class="line"><span style="color:#24292F;">    ),</span></span>
<span class="line"><span style="color:#24292F;">  },</span></span>
<span class="line"><span style="color:#24292F;">  destination_id: {</span></span>
<span class="line"><span style="color:#24292F;">    expression: Expression.variantsUnwrapped.</span><span style="color:#8250DF;">Raw</span><span style="color:#24292F;">(</span></span>
<span class="line"><span style="color:#24292F;">      Value.variantsUnwrapped.</span><span style="color:#8250DF;">Id</span><span style="color:#24292F;">(</span></span>
<span class="line"><span style="color:#24292F;">        IdBox.variantsUnwrapped.</span><span style="color:#8250DF;">AssetDefinitionId</span><span style="color:#24292F;">({</span></span>
<span class="line"><span style="color:#24292F;">          name: </span><span style="color:#0A3069;">&#39;roses&#39;</span><span style="color:#24292F;">,</span></span>
<span class="line"><span style="color:#24292F;">          domain_name: </span><span style="color:#0A3069;">&#39;wonderland&#39;</span><span style="color:#24292F;">,</span></span>
<span class="line"><span style="color:#24292F;">        }),</span></span>
<span class="line"><span style="color:#24292F;">      ),</span></span>
<span class="line"><span style="color:#24292F;">    ),</span></span>
<span class="line"><span style="color:#24292F;">  },</span></span>
<span class="line"><span style="color:#24292F;">})</span></span>
<span class="line"></span></code></pre></div><p>Again it should be emphasised that an Iroha 2 network is strongly typed. You need to take special care to make sure that only unsigned integers are passed to the <code>Value.variantsUnwrapped.U32</code> factory method. Fixed precision values also need to be taken into consideration. Any attempt to add to or subtract from a negative Fixed-precision value will result in an error.</p><h2 id="_6-visualizing-outputs" tabindex="-1">6. Visualizing outputs <a class="header-anchor" href="#_6-visualizing-outputs" aria-hidden="true">#</a></h2><p>Finally, we should talk about visualising data. The Rust API is currently the most complete in terms of available queries and instructions. After all, this is the language in which Iroha 2 was built.</p><p>Let&#39;s build simple Vue 3 Listener component that uses Events API to catch pipeline events and renders them!</p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>The example above uses Composition API + <code>&lt;script setup&gt;</code> syntax.</p></div><p>In our component we will render a button to toggle listening state, and a list with registered events. Our events filter is set up to catch any transaction status change.</p><div class="language-ts"><pre class="shiki shiki-light" style="background-color:#ffffff;"><code><span class="line"><span style="color:#CF222E;">import</span><span style="color:#24292F;"> { SetupEventsReturn } </span><span style="color:#CF222E;">from</span><span style="color:#24292F;"> </span><span style="color:#0A3069;">&#39;@iroha2/client&#39;</span></span>
<span class="line"><span style="color:#CF222E;">import</span><span style="color:#24292F;"> {</span></span>
<span class="line"><span style="color:#24292F;">  EntityType,</span></span>
<span class="line"><span style="color:#24292F;">  EventFilter,</span></span>
<span class="line"><span style="color:#24292F;">  OptionEntityType,</span></span>
<span class="line"><span style="color:#24292F;">  OptionHash,</span></span>
<span class="line"><span style="color:#24292F;">} </span><span style="color:#CF222E;">from</span><span style="color:#24292F;"> </span><span style="color:#0A3069;">&#39;@iroha2/data-model&#39;</span></span>
<span class="line"><span style="color:#CF222E;">import</span><span style="color:#24292F;"> { shallowReactive, shallowRef, computed } </span><span style="color:#CF222E;">from</span><span style="color:#24292F;"> </span><span style="color:#0A3069;">&#39;vue&#39;</span></span>
<span class="line"><span style="color:#CF222E;">import</span><span style="color:#24292F;"> { bytesToHex } </span><span style="color:#CF222E;">from</span><span style="color:#24292F;"> </span><span style="color:#0A3069;">&#39;hada&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6E7781;">// Let&#39;s assume that you already have initialized client</span></span>
<span class="line"><span style="color:#CF222E;">import</span><span style="color:#24292F;"> { client } </span><span style="color:#CF222E;">from</span><span style="color:#24292F;"> </span><span style="color:#0A3069;">&#39;../client&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6E7781;">// Where and how to store collected events</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CF222E;">type</span><span style="color:#24292F;"> </span><span style="color:#953800;">EventData</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> {</span></span>
<span class="line"><span style="color:#24292F;">  </span><span style="color:#953800;">hash</span><span style="color:#CF222E;">:</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">string</span></span>
<span class="line"><span style="color:#24292F;">  </span><span style="color:#953800;">status</span><span style="color:#CF222E;">:</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">string</span></span>
<span class="line"><span style="color:#24292F;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CF222E;">const</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">events</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> </span><span style="color:#8250DF;">shallowReactive</span><span style="color:#24292F;">&lt;</span><span style="color:#953800;">EventData</span><span style="color:#24292F;">[]&gt;([])</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CF222E;">const</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">currentListener</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> </span><span style="color:#8250DF;">shallowRef</span><span style="color:#24292F;">&lt;</span><span style="color:#0550AE;">null</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">|</span><span style="color:#24292F;"> </span><span style="color:#953800;">SetupEventsReturn</span><span style="color:#24292F;">&gt;(</span><span style="color:#0550AE;">null</span><span style="color:#24292F;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CF222E;">const</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">isListening</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> </span><span style="color:#8250DF;">computed</span><span style="color:#24292F;">(() </span><span style="color:#CF222E;">=&gt;</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">!!</span><span style="color:#24292F;">currentListener.value)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CF222E;">async</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">function</span><span style="color:#24292F;"> </span><span style="color:#8250DF;">startListening</span><span style="color:#24292F;">() {</span></span>
<span class="line"><span style="color:#24292F;">  currentListener.value </span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">await</span><span style="color:#24292F;"> client.</span><span style="color:#8250DF;">listenForEvents</span><span style="color:#24292F;">({</span></span>
<span class="line"><span style="color:#24292F;">    filter: EventFilter.</span><span style="color:#8250DF;">wrap</span><span style="color:#24292F;">(</span></span>
<span class="line"><span style="color:#24292F;">      EventFilter.variantsUnwrapped.</span><span style="color:#8250DF;">Pipeline</span><span style="color:#24292F;">({</span></span>
<span class="line"><span style="color:#24292F;">        entity: OptionEntityType.variantsUnwrapped.</span><span style="color:#8250DF;">Some</span><span style="color:#24292F;">(</span></span>
<span class="line"><span style="color:#24292F;">          EntityType.variantsUnwrapped.Transaction,</span></span>
<span class="line"><span style="color:#24292F;">        ),</span></span>
<span class="line"><span style="color:#24292F;">        hash: OptionHash.variantsUnwrapped.None,</span></span>
<span class="line"><span style="color:#24292F;">      }),</span></span>
<span class="line"><span style="color:#24292F;">    ),</span></span>
<span class="line"><span style="color:#24292F;">  })</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292F;">  currentListener.value.ee.</span><span style="color:#8250DF;">on</span><span style="color:#24292F;">(</span><span style="color:#0A3069;">&#39;event&#39;</span><span style="color:#24292F;">, (</span><span style="color:#953800;">event</span><span style="color:#24292F;">) </span><span style="color:#CF222E;">=&gt;</span><span style="color:#24292F;"> {</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#CF222E;">const</span><span style="color:#24292F;"> { </span><span style="color:#0550AE;">hash</span><span style="color:#24292F;">, </span><span style="color:#0550AE;">status</span><span style="color:#24292F;"> } </span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> event.</span><span style="color:#8250DF;">unwrap</span><span style="color:#24292F;">().</span><span style="color:#8250DF;">as</span><span style="color:#24292F;">(</span><span style="color:#0A3069;">&#39;Pipeline&#39;</span><span style="color:#24292F;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292F;">    events.</span><span style="color:#8250DF;">push</span><span style="color:#24292F;">({</span></span>
<span class="line"><span style="color:#24292F;">      hash: </span><span style="color:#8250DF;">bytesToHex</span><span style="color:#24292F;">([</span><span style="color:#CF222E;">...</span><span style="color:#24292F;">hash]),</span></span>
<span class="line"><span style="color:#24292F;">      status: status.</span><span style="color:#8250DF;">match</span><span style="color:#24292F;">({</span></span>
<span class="line"><span style="color:#24292F;">        </span><span style="color:#8250DF;">Validating</span><span style="color:#24292F;">: () </span><span style="color:#CF222E;">=&gt;</span><span style="color:#24292F;"> </span><span style="color:#0A3069;">&#39;validating&#39;</span><span style="color:#24292F;">,</span></span>
<span class="line"><span style="color:#24292F;">        </span><span style="color:#8250DF;">Committed</span><span style="color:#24292F;">: () </span><span style="color:#CF222E;">=&gt;</span><span style="color:#24292F;"> </span><span style="color:#0A3069;">&#39;committed&#39;</span><span style="color:#24292F;">,</span></span>
<span class="line"><span style="color:#24292F;">        </span><span style="color:#8250DF;">Rejected</span><span style="color:#24292F;">: (</span><span style="color:#953800;">_reason</span><span style="color:#24292F;">) </span><span style="color:#CF222E;">=&gt;</span><span style="color:#24292F;"> </span><span style="color:#0A3069;">&#39;rejected with some reason&#39;</span><span style="color:#24292F;">,</span></span>
<span class="line"><span style="color:#24292F;">      }),</span></span>
<span class="line"><span style="color:#24292F;">    })</span></span>
<span class="line"><span style="color:#24292F;">  })</span></span>
<span class="line"><span style="color:#24292F;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CF222E;">function</span><span style="color:#24292F;"> </span><span style="color:#8250DF;">stopListening</span><span style="color:#24292F;">() {</span></span>
<span class="line"><span style="color:#24292F;">  currentListener.value?.</span><span style="color:#8250DF;">close</span><span style="color:#24292F;">()</span></span>
<span class="line"><span style="color:#24292F;">  currentListener.value </span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">null</span></span>
<span class="line"><span style="color:#24292F;">}</span></span>
<span class="line"></span></code></pre></div><p>And finally, our component’s template:</p><div class="language-vue-html"><pre class="shiki shiki-light" style="background-color:#ffffff;"><code><span class="line"><span style="color:#24292F;">&lt;</span><span style="color:#116329;">div</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"><span style="color:#24292F;">  &lt;</span><span style="color:#116329;">p</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"><span style="color:#24292F;">    &lt;</span><span style="color:#116329;">button</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">v-if</span><span style="color:#24292F;">=</span><span style="color:#0A3069;">&quot;</span><span style="color:#24292F;">isListening</span><span style="color:#0A3069;">&quot;</span><span style="color:#24292F;"> @</span><span style="color:#0550AE;">click</span><span style="color:#24292F;">=</span><span style="color:#0A3069;">&quot;</span><span style="color:#24292F;">stopListening</span><span style="color:#0A3069;">&quot;</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"><span style="color:#24292F;">      Stop listening</span></span>
<span class="line"><span style="color:#24292F;">    &lt;/</span><span style="color:#116329;">button</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"><span style="color:#24292F;">    &lt;</span><span style="color:#116329;">button</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">v-else</span><span style="color:#24292F;"> @</span><span style="color:#0550AE;">click</span><span style="color:#24292F;">=</span><span style="color:#0A3069;">&quot;</span><span style="color:#24292F;">startListening</span><span style="color:#0A3069;">&quot;</span><span style="color:#24292F;">&gt;Listen&lt;/</span><span style="color:#116329;">button</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"><span style="color:#24292F;">  &lt;/</span><span style="color:#116329;">p</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292F;">  &lt;</span><span style="color:#116329;">p</span><span style="color:#24292F;">&gt;Events:&lt;/</span><span style="color:#116329;">p</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292F;">  &lt;</span><span style="color:#116329;">ul</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"><span style="color:#24292F;">    &lt;</span><span style="color:#116329;">li</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">v-for</span><span style="color:#24292F;">=</span><span style="color:#0A3069;">&quot;</span><span style="color:#24292F;">{ hash, status } </span><span style="color:#CF222E;">in</span><span style="color:#24292F;"> events</span><span style="color:#0A3069;">&quot;</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"><span style="color:#24292F;">      Transaction</span></span>
<span class="line"><span style="color:#24292F;">      &lt;</span><span style="color:#116329;">code</span><span style="color:#24292F;">&gt;{{ hash }}&lt;/</span><span style="color:#116329;">code</span><span style="color:#24292F;">&gt; status: {{ status }}</span></span>
<span class="line"><span style="color:#24292F;">    &lt;/</span><span style="color:#116329;">li</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"><span style="color:#24292F;">  &lt;/</span><span style="color:#116329;">ul</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"><span style="color:#24292F;">&lt;/</span><span style="color:#116329;">div</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"></span></code></pre></div><p>That’s it! Here is a small demo with usage of this component:</p><div class="border border-solid border-gray-300 rounded-md"><p><img src="/iroha-2-docs/assets/javascript-output.46ef39fe.gif" alt=""></p></div></div></div><footer class="page-footer" data-v-5ab2b583 data-v-c710f5fe><div class="edit" data-v-c710f5fe><div class="edit-link" data-v-c710f5fe data-v-dc147d58><a class="link" href="https://github.com/hyperledger/iroha-2-docs/edit/master/src/guide/javascript.md" target="_blank" rel="noopener noreferrer" data-v-dc147d58>Edit this page <svg class="icon outbound icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-dc147d58><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div><div class="updated" data-v-c710f5fe><p class="last-updated" data-v-c710f5fe data-v-ae38ef34><span class="prefix" data-v-ae38ef34>Last Updated:</span><span class="datetime" data-v-ae38ef34></span></p></div></footer><div class="next-and-prev-link" data-v-5ab2b583 data-v-24e45740><div class="container" data-v-24e45740><div class="prev" data-v-24e45740><a class="link" href="/iroha-2-docs/guide/kotlin-java" data-v-24e45740><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon icon-prev" data-v-24e45740><path d="M19,11H7.4l5.3-5.3c0.4-0.4,0.4-1,0-1.4s-1-0.4-1.4,0l-7,7c-0.1,0.1-0.2,0.2-0.2,0.3c-0.1,0.2-0.1,0.5,0,0.8c0.1,0.1,0.1,0.2,0.2,0.3l7,7c0.2,0.2,0.5,0.3,0.7,0.3s0.5-0.1,0.7-0.3c0.4-0.4,0.4-1,0-1.4L7.4,13H19c0.6,0,1-0.4,1-1S19.6,11,19,11z"></path></svg><span class="text" data-v-24e45740>Kotlin/Java</span></a></div><div class="next" data-v-24e45740><a class="link" href="/iroha-2-docs/guide/conclusions" data-v-24e45740><span class="text" data-v-24e45740>Conclusions</span><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon icon-next" data-v-24e45740><path d="M19.9,12.4c0.1-0.2,0.1-0.5,0-0.8c-0.1-0.1-0.1-0.2-0.2-0.3l-7-7c-0.4-0.4-1-0.4-1.4,0s-0.4,1,0,1.4l5.3,5.3H5c-0.6,0-1,0.4-1,1s0.4,1,1,1h11.6l-5.3,5.3c-0.4,0.4-0.4,1,0,1.4c0.2,0.2,0.5,0.3,0.7,0.3s0.5-0.1,0.7-0.3l7-7C19.8,12.6,19.9,12.5,19.9,12.4z"></path></svg></a></div></div></div><!--[--><!--]--></div></main></div><!----><!--]--></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"api_index.md\":\"b9fb2d72\",\"guide_appendix.md\":\"b560ba6c\",\"guide_appendix_client-configuration.md\":\"334648fb\",\"guide_appendix_genesis.md\":\"bd69e44d\",\"guide_appendix_intro.md\":\"33914db7\",\"guide_appendix_keys.md\":\"0909bf9a\",\"guide_appendix_kura.md\":\"ee69c26e\",\"guide_appendix_logger.md\":\"8ebe1eba\",\"guide_appendix_peer-configuration.md\":\"b592d933\",\"guide_appendix_public-addresses.md\":\"55133da6\",\"guide_appendix_running-iroha-on-bare-metal.md\":\"e15fb1f8\",\"guide_appendix_trusted-peers.md\":\"305e54d8\",\"guide_bash.md\":\"cb5e50a6\",\"guide_build-and-install.md\":\"4c4acfe8\",\"guide_conclusions.md\":\"804301c5\",\"guide_javascript.md\":\"aca015ee\",\"guide_kotlin-java.md\":\"812cfc64\",\"guide_python.md\":\"11da7590\",\"guide_rust.md\":\"c70ff810\",\"index.md\":\"8bf40a12\"}")</script>
    <script type="module" async src="/iroha-2-docs/assets/app.5cbb4beb.js"></script>
    
  </body>
</html>