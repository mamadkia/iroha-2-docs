<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Appendix | Hyperledger Iroha 2 Tutorial</title>
    <meta name="description" content="Documented tutorial for Hyperledger Iroha 2 outlining the main differences between Iroha versions along with a walkthrough and additional resources.">
    <link rel="stylesheet" href="/iroha-2-docs/assets/style.34fbf971.css">
    <link rel="modulepreload" href="/iroha-2-docs/assets/chunks/appendix_running-iroha_cli-output.ae66e25c.js">
    <link rel="modulepreload" href="/iroha-2-docs/assets/app.5cbb4beb.js">
    <link rel="modulepreload" href="/iroha-2-docs/assets/guide_appendix.md.b560ba6c.lean.js">
    
    <meta name="twitter:title" content="Appendix | Hyperledger Iroha 2 Tutorial">
  <meta property="og:title" content="Appendix | Hyperledger Iroha 2 Tutorial">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme"><header class="nav-bar" data-v-2170b094><div class="sidebar-button" data-v-2170b094><svg class="icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z" class></path></svg></div><a class="nav-bar-title" href="/iroha-2-docs/" aria-label="Hyperledger Iroha 2 Tutorial, back to home" data-v-2170b094 data-v-d97bc718><img class="logo" src="/iroha-2-docs/logo.svg" alt="Logo" data-v-d97bc718> Hyperledger Iroha 2 Tutorial</a><div class="flex-grow" data-v-2170b094></div><div class="nav" data-v-2170b094><nav class="nav-links" data-v-2170b094 data-v-2b096b62><!--[--><div class="item" data-v-2b096b62><div class="nav-link" data-v-2b096b62 data-v-452f0eb9><a class="item active" href="/iroha-2-docs/" data-v-452f0eb9>Guide <!----></a></div></div><!--]--><!----><div class="item" data-v-2b096b62><div class="nav-link" data-v-2b096b62 data-v-452f0eb9><a class="item isExternal" href="https://github.com/hyperledger/iroha-2-docs" target="_blank" rel="noopener noreferrer" data-v-452f0eb9>GitHub <svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-452f0eb9><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div></nav></div><!--[--><!--]--></header><aside class="sidebar" data-v-44509ecb><nav class="nav-links nav" data-v-44509ecb data-v-2b096b62><!--[--><div class="item" data-v-2b096b62><div class="nav-link" data-v-2b096b62 data-v-452f0eb9><a class="item active" href="/iroha-2-docs/" data-v-452f0eb9>Guide <!----></a></div></div><!--]--><!----><div class="item" data-v-2b096b62><div class="nav-link" data-v-2b096b62 data-v-452f0eb9><a class="item isExternal" href="https://github.com/hyperledger/iroha-2-docs" target="_blank" rel="noopener noreferrer" data-v-452f0eb9>GitHub <svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-452f0eb9><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div></nav><!--[--><!--]--><ul class="sidebar-links" data-v-44509ecb><!--[--><li class="sidebar-link"><p class="sidebar-link-item">Getting started</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/iroha-2-docs/">Introduction</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/iroha-2-docs/guide/build-and-install">Build and Install</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">Language-specific guides</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/iroha-2-docs/guide/bash">Bash</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/iroha-2-docs/guide/python">Python 3</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/iroha-2-docs/guide/rust">Rust</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/iroha-2-docs/guide/kotlin-java">Kotlin/Java</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/iroha-2-docs/guide/javascript">JavaScript</a><!----></li></ul></li><li class="sidebar-link"><a class="sidebar-link-item" href="/iroha-2-docs/guide/conclusions">Conclusions</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/iroha-2-docs/guide/appendix/intro">Appendix</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/iroha-2-docs/guide/appendix/peer-configuration">Peer Configuration</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/iroha-2-docs/guide/appendix/trusted-peers">Trusted Peers</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/iroha-2-docs/guide/appendix/kura">Kura</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/iroha-2-docs/guide/appendix/public-addresses">Iroha Public Addresses</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/iroha-2-docs/guide/appendix/logger">Logger</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/iroha-2-docs/guide/appendix/genesis">Genesis Block</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/iroha-2-docs/guide/appendix/client-configuration">Client Configuration</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/iroha-2-docs/guide/appendix/running-iroha-on-bare-metal">Running Iroha On Bare Metal</a><!----></li></ul></li><!--]--></ul><!--[--><!--]--></aside><div class="sidebar-mask"></div><main class="page" data-v-5ab2b583><div class="container" data-v-5ab2b583><!--[--><!--]--><div style="position:relative;" class="content" data-v-5ab2b583><div><h1 id="appendix" tabindex="-1">Appendix <a class="header-anchor" href="#appendix" aria-hidden="true">#</a></h1><p>This section will cover the configuration files in the first section with more detail. There are three configuration files specifically: <em>peer configuration</em>, the <em>genesis block</em> and the <em>client configuration</em>. Finally, keys within Iroha 2 will be covered in , including their configuration and use.</p><h2 id="peer-configuration" tabindex="-1">Peer Configuration <a class="header-anchor" href="#peer-configuration" aria-hidden="true">#</a></h2><p>The peer configuration JSON <code>/configs/peer/config.json</code> is the file that determines how your blockchain operates: we won&#39;t look at it now, but really the only things that you need to worry about are the <code>TRUSTED_PEERS</code> , the <code>KURA</code> <code>BLOCK_STORE_PATH</code> and the <code>TORII</code> <code>P2P_ADDR</code> and <code>API_ADDR</code>. The <code>PUBLIC_KEY</code> and <code>PRIVATE_KEY</code> options will be covered at a later stage. The remaining options are for tuning Iroha, so you don&#39;t want to touch them unless you know what you&#39;re doing.</p><h3 id="trusted-peers" tabindex="-1">Trusted peers <a class="header-anchor" href="#trusted-peers" aria-hidden="true">#</a></h3><p>Iroha is a blockchain ledger. In order for it to work optimally and be Byzantine-fault tolerant with the maximum number of faults allowed, it needs to be started with a set number of peers: 4, 7, 10 … 3f+1, where f is the number of faults. So usually, when you want to start an Iroha deployment you should already know a number of peers that you can trust and join their blockchain. The way it works in the examples, is that you just specify in four<code>config.json</code> files four peers with their public keys and API addresses. Since Iroha has no automatic peer discovery, the only other way to make peers known to each other is to use the <code>iroha_client_cli</code> to register new peers. This is not too difficult with the provided client libraries. In fact using Python’s beautiful soup, the curated list of peers can be updated, registered and un-registered on its own.</p><h3 id="kura" tabindex="-1">Kura <a class="header-anchor" href="#kura" aria-hidden="true">#</a></h3><p>Kura is the “warehouse” engine of Iroha; it can store blocks in custom locations, if for some reason <code>./blocks</code> is not available or desirable. There are plans to make the Iroha’s storage tiered: when you reach a certain number of blocks, they get moved elsewhere. The <code>KURA</code> init mode at present does nothing. In the future, it will affect whether or not your block storage does a <code>strict</code> initialisation: checks everything, or a <code>fast</code> one, where everything is “probably alright™”.</p><h3 id="iroha-public-addresses" tabindex="-1">Iroha public addresses <a class="header-anchor" href="#iroha-public-addresses" aria-hidden="true">#</a></h3><p><code>TORII</code> the gatekeeper is the module in charge of handling in-coming and out-going connnections. The <code>API_URL</code> is the location to which the client(s) make their requests. You can use it to change some peer-specific configuration options too. While we could give you the examples here, the only up-to-date description can be found in the Iroha’s immediate <a href="https://github.com/hyperledger/iroha/blob/iroha2-dev/docs/source/references/api_spec.md" target="_blank" rel="noopener noreferrer">documentation on GitHub</a>. Most of the time, the only reason to change the <code>API_URL</code> is to change the port, in case <code>8080</code> is either closed, or if you want to randomise ports to avoid certain kinds of attacks. The <code>P2P_ADDR</code> is the internal address used for communication between peers. Take note of <strong>this address</strong> for inclusion in the <code>TRUSTED_PEERS</code> section of the configuration file. Lastly, (and not in the example configuration) you have the prometheus endpoint address. It’s set by adding a value <code>&quot;TELEMETRY_URL&quot;: &quot;127.0.0.1:8180&quot;</code>, to the <code>TORII</code> section. It’s not meant to be human-readable, but a <code>GET</code> request to the <code>127.0.0.1:8180/status</code> will give you a JSON-encoded representation of the top-level metrics, while a <code>GET</code> request to <code>127.0.0.1:8180/metrics</code> will give you a (somewhat verbose) list of all available metrics gathered in Iroha. You might want to change this, if you’re having trouble gathering metrics using <code>prometheus</code>.</p><h3 id="logger" tabindex="-1">Logger <a class="header-anchor" href="#logger" aria-hidden="true">#</a></h3><p>This is possibly the easiest to understand. <code>&quot;MAX_LOG_LEVEL&quot;: &quot;WARN&quot;</code>, changes the logging level to <code>WARN</code>. This means that you don’t get any messages, unless they’re either a warning or an error message. The available options are <code>TRACE</code> (every time you enter a function), <code>DEBUG</code> information that we use when we know something went wrong, <code>INFO</code> the default, <code>WARN</code> and <code>ERROR</code>, which silences any logging except for error messages. Another useful option might be to use <code>&quot;LOG_FILE_PATH&quot;: bunyan.json</code> . What this will do, is create (if it didn’t exist already) a file called <code>bunyan.json</code> that contains the logging in a structured format. This is extremely useful for two reasons: first, you can use the <code>bunyan</code> log viewer to filter information more precisely than Iroha would allow you to do. <em>Want only messages from a specific module or package? You can do that with bunyan</em>. Secondly, while copying logs is not too big of a problem if your instance is just a small setup, for bigger and longer running the process the larger the log will be. Having it be saved to a file makes much more sense in that case. (<strong>TIP</strong>: you can also set this to <code>/dev/stdout</code> if you want to use bunyan’s logging facilities directly, but don’t want to waste space in the filesystem).</p><h2 id="genesis-block" tabindex="-1">Genesis Block <a class="header-anchor" href="#genesis-block" aria-hidden="true">#</a></h2><p>The genesis block is the first block in your blockchain. It&#39;s never empty, even if <code>configs/peer/genesis.json</code> is. We recommend adding at least one more account to the genesis block; in our case, it was <em>alice</em>@wonderland, which has the public key <code>ed01207233bfc89dcbd68c19fde6ce6158225298ec1131b6a130d1aeb454c1ab5183c0</code> . Think of it as the password used to &quot;log in&quot; as <em>alice</em>. <em>Also note, <strong>Iroha is case-sensitive,</strong> meaning that <strong>Alice@wonderland is different from alice@wonderland.</strong></em> It should go without saying that <em>alice@wonderland</em> is not the same as <em>alice@looking_glass</em> either.</p><details class="details custom-block"><summary>Genesis Block</summary><div class="language-json"><pre class="shiki shiki-light" style="background-color:#ffffff;"><code><span class="line"><span style="color:#24292F;">{</span></span>
<span class="line"><span style="color:#24292F;">  </span><span style="color:#0550AE;">&quot;transactions&quot;</span><span style="color:#24292F;">: [</span></span>
<span class="line"><span style="color:#24292F;">    {</span></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#0550AE;">&quot;isi&quot;</span><span style="color:#24292F;">: [</span></span>
<span class="line"><span style="color:#24292F;">        {</span></span>
<span class="line"><span style="color:#24292F;">          </span><span style="color:#0550AE;">&quot;Register&quot;</span><span style="color:#24292F;">: {</span></span>
<span class="line"><span style="color:#24292F;">            </span><span style="color:#0550AE;">&quot;object&quot;</span><span style="color:#24292F;">: {</span></span>
<span class="line"><span style="color:#24292F;">              </span><span style="color:#0550AE;">&quot;Raw&quot;</span><span style="color:#24292F;">: {</span></span>
<span class="line"><span style="color:#24292F;">                </span><span style="color:#0550AE;">&quot;Identifiable&quot;</span><span style="color:#24292F;">: {</span></span>
<span class="line"><span style="color:#24292F;">                  </span><span style="color:#0550AE;">&quot;Domain&quot;</span><span style="color:#24292F;">: {</span></span>
<span class="line"><span style="color:#24292F;">                    </span><span style="color:#0550AE;">&quot;name&quot;</span><span style="color:#24292F;">: </span><span style="color:#0A3069;">&quot;wonderland&quot;</span><span style="color:#24292F;">,</span></span>
<span class="line"><span style="color:#24292F;">                    </span><span style="color:#0550AE;">&quot;accounts&quot;</span><span style="color:#24292F;">: {},</span></span>
<span class="line"><span style="color:#24292F;">                    </span><span style="color:#0550AE;">&quot;asset_definitions&quot;</span><span style="color:#24292F;">: {},</span></span>
<span class="line"><span style="color:#24292F;">                    </span><span style="color:#0550AE;">&quot;metadata&quot;</span><span style="color:#24292F;">: {}</span></span>
<span class="line"><span style="color:#24292F;">                  }</span></span>
<span class="line"><span style="color:#24292F;">                }</span></span>
<span class="line"><span style="color:#24292F;">              }</span></span>
<span class="line"><span style="color:#24292F;">            }</span></span>
<span class="line"><span style="color:#24292F;">          }</span></span>
<span class="line"><span style="color:#24292F;">        },</span></span>
<span class="line"><span style="color:#24292F;">        {</span></span>
<span class="line"><span style="color:#24292F;">          </span><span style="color:#0550AE;">&quot;Register&quot;</span><span style="color:#24292F;">: {</span></span>
<span class="line"><span style="color:#24292F;">            </span><span style="color:#0550AE;">&quot;object&quot;</span><span style="color:#24292F;">: {</span></span>
<span class="line"><span style="color:#24292F;">              </span><span style="color:#0550AE;">&quot;Raw&quot;</span><span style="color:#24292F;">: {</span></span>
<span class="line"><span style="color:#24292F;">                </span><span style="color:#0550AE;">&quot;Identifiable&quot;</span><span style="color:#24292F;">: {</span></span>
<span class="line"><span style="color:#24292F;">                  </span><span style="color:#0550AE;">&quot;NewAccount&quot;</span><span style="color:#24292F;">: {</span></span>
<span class="line"><span style="color:#24292F;">                    </span><span style="color:#0550AE;">&quot;id&quot;</span><span style="color:#24292F;">: {</span></span>
<span class="line"><span style="color:#24292F;">                      </span><span style="color:#0550AE;">&quot;name&quot;</span><span style="color:#24292F;">: </span><span style="color:#0A3069;">&quot;alice&quot;</span><span style="color:#24292F;">,</span></span>
<span class="line"><span style="color:#24292F;">                      </span><span style="color:#0550AE;">&quot;domain_name&quot;</span><span style="color:#24292F;">: </span><span style="color:#0A3069;">&quot;wonderland&quot;</span></span>
<span class="line"><span style="color:#24292F;">                    },</span></span>
<span class="line"><span style="color:#24292F;">                    </span><span style="color:#0550AE;">&quot;signatories&quot;</span><span style="color:#24292F;">: [</span></span>
<span class="line"><span style="color:#24292F;">                      </span><span style="color:#0A3069;">&quot;ed01207233bfc89dcbd68c19fde6ce6158225298ec1131b6a130d1aeb454c1ab5183c0&quot;</span></span>
<span class="line"><span style="color:#24292F;">                    ],</span></span>
<span class="line"><span style="color:#24292F;">                    </span><span style="color:#0550AE;">&quot;metadata&quot;</span><span style="color:#24292F;">: {}</span></span>
<span class="line"><span style="color:#24292F;">                  }</span></span>
<span class="line"><span style="color:#24292F;">                }</span></span>
<span class="line"><span style="color:#24292F;">              }</span></span>
<span class="line"><span style="color:#24292F;">            }</span></span>
<span class="line"><span style="color:#24292F;">          }</span></span>
<span class="line"><span style="color:#24292F;">        },</span></span>
<span class="line"><span style="color:#24292F;">        {</span></span>
<span class="line"><span style="color:#24292F;">          </span><span style="color:#0550AE;">&quot;Register&quot;</span><span style="color:#24292F;">: {</span></span>
<span class="line"><span style="color:#24292F;">            </span><span style="color:#0550AE;">&quot;object&quot;</span><span style="color:#24292F;">: {</span></span>
<span class="line"><span style="color:#24292F;">              </span><span style="color:#0550AE;">&quot;Raw&quot;</span><span style="color:#24292F;">: {</span></span>
<span class="line"><span style="color:#24292F;">                </span><span style="color:#0550AE;">&quot;Identifiable&quot;</span><span style="color:#24292F;">: {</span></span>
<span class="line"><span style="color:#24292F;">                  </span><span style="color:#0550AE;">&quot;AssetDefinition&quot;</span><span style="color:#24292F;">: {</span></span>
<span class="line"><span style="color:#24292F;">                    </span><span style="color:#0550AE;">&quot;id&quot;</span><span style="color:#24292F;">: {</span></span>
<span class="line"><span style="color:#24292F;">                      </span><span style="color:#0550AE;">&quot;name&quot;</span><span style="color:#24292F;">: </span><span style="color:#0A3069;">&quot;rose&quot;</span><span style="color:#24292F;">,</span></span>
<span class="line"><span style="color:#24292F;">                      </span><span style="color:#0550AE;">&quot;domain_name&quot;</span><span style="color:#24292F;">: </span><span style="color:#0A3069;">&quot;wonderland&quot;</span></span>
<span class="line"><span style="color:#24292F;">                    },</span></span>
<span class="line"><span style="color:#24292F;">                    </span><span style="color:#0550AE;">&quot;value_type&quot;</span><span style="color:#24292F;">: </span><span style="color:#0A3069;">&quot;Quantity&quot;</span><span style="color:#24292F;">,</span></span>
<span class="line"><span style="color:#24292F;">                    </span><span style="color:#0550AE;">&quot;metadata&quot;</span><span style="color:#24292F;">: {},</span></span>
<span class="line"><span style="color:#24292F;">                    </span><span style="color:#0550AE;">&quot;mintable&quot;</span><span style="color:#24292F;">: </span><span style="color:#0550AE;">true</span></span>
<span class="line"><span style="color:#24292F;">                  }</span></span>
<span class="line"><span style="color:#24292F;">                }</span></span>
<span class="line"><span style="color:#24292F;">              }</span></span>
<span class="line"><span style="color:#24292F;">            }</span></span>
<span class="line"><span style="color:#24292F;">          }</span></span>
<span class="line"><span style="color:#24292F;">        },</span></span>
<span class="line"><span style="color:#24292F;">        {</span></span>
<span class="line"><span style="color:#24292F;">          </span><span style="color:#0550AE;">&quot;Mint&quot;</span><span style="color:#24292F;">: {</span></span>
<span class="line"><span style="color:#24292F;">            </span><span style="color:#0550AE;">&quot;object&quot;</span><span style="color:#24292F;">: {</span></span>
<span class="line"><span style="color:#24292F;">              </span><span style="color:#0550AE;">&quot;Raw&quot;</span><span style="color:#24292F;">: {</span></span>
<span class="line"><span style="color:#24292F;">                </span><span style="color:#0550AE;">&quot;U32&quot;</span><span style="color:#24292F;">: </span><span style="color:#0550AE;">13</span></span>
<span class="line"><span style="color:#24292F;">              }</span></span>
<span class="line"><span style="color:#24292F;">            },</span></span>
<span class="line"><span style="color:#24292F;">            </span><span style="color:#0550AE;">&quot;destination_id&quot;</span><span style="color:#24292F;">: {</span></span>
<span class="line"><span style="color:#24292F;">              </span><span style="color:#0550AE;">&quot;Raw&quot;</span><span style="color:#24292F;">: {</span></span>
<span class="line"><span style="color:#24292F;">                </span><span style="color:#0550AE;">&quot;Id&quot;</span><span style="color:#24292F;">: {</span></span>
<span class="line"><span style="color:#24292F;">                  </span><span style="color:#0550AE;">&quot;AssetId&quot;</span><span style="color:#24292F;">: {</span></span>
<span class="line"><span style="color:#24292F;">                    </span><span style="color:#0550AE;">&quot;definition_id&quot;</span><span style="color:#24292F;">: {</span></span>
<span class="line"><span style="color:#24292F;">                      </span><span style="color:#0550AE;">&quot;name&quot;</span><span style="color:#24292F;">: </span><span style="color:#0A3069;">&quot;rose&quot;</span><span style="color:#24292F;">,</span></span>
<span class="line"><span style="color:#24292F;">                      </span><span style="color:#0550AE;">&quot;domain_name&quot;</span><span style="color:#24292F;">: </span><span style="color:#0A3069;">&quot;wonderland&quot;</span></span>
<span class="line"><span style="color:#24292F;">                    },</span></span>
<span class="line"><span style="color:#24292F;">                    </span><span style="color:#0550AE;">&quot;account_id&quot;</span><span style="color:#24292F;">: {</span></span>
<span class="line"><span style="color:#24292F;">                      </span><span style="color:#0550AE;">&quot;name&quot;</span><span style="color:#24292F;">: </span><span style="color:#0A3069;">&quot;alice&quot;</span><span style="color:#24292F;">,</span></span>
<span class="line"><span style="color:#24292F;">                      </span><span style="color:#0550AE;">&quot;domain_name&quot;</span><span style="color:#24292F;">: </span><span style="color:#0A3069;">&quot;wonderland&quot;</span></span>
<span class="line"><span style="color:#24292F;">                    }</span></span>
<span class="line"><span style="color:#24292F;">                  }</span></span>
<span class="line"><span style="color:#24292F;">                }</span></span>
<span class="line"><span style="color:#24292F;">              }</span></span>
<span class="line"><span style="color:#24292F;">            }</span></span>
<span class="line"><span style="color:#24292F;">          }</span></span>
<span class="line"><span style="color:#24292F;">        }</span></span>
<span class="line"><span style="color:#24292F;">      ]</span></span>
<span class="line"><span style="color:#24292F;">    }</span></span>
<span class="line"><span style="color:#24292F;">  ]</span></span>
<span class="line"><span style="color:#24292F;">}</span></span>
<span class="line"></span></code></pre></div></details><h2 id="client-configuration" tabindex="-1">Client Configuration <a class="header-anchor" href="#client-configuration" aria-hidden="true">#</a></h2><p>This tutorial will not go in detail about the options you can adjust with the client configuration settings, instead we will provide a broad overview of what is available in Iroha2. First, the <code>TORII_API_URL</code> is the same as <code>TORII</code> <code>API_ADDR</code> in the peer configuration. You should also add either <code>http://</code> or (<em>preferably</em>) <code>https://</code> to the address. If you are setting up an Iroha peer, you should probably set up a domain for public blockchains, while bare sockets are enough for a local private deployment. The <code>ACCOUNT_ID</code> should be self-explanatory: the only thing you need to worry about, is that the account must exist in the blockchain. In the example <code>genesis.json</code>, you can see how we&#39;ve set *alice@*wonderland up.</p><h2 id="keys" tabindex="-1">Keys <a class="header-anchor" href="#keys" aria-hidden="true">#</a></h2><p>Now is a good time to start worrying about Public key cryptography, so we&#39;ll give you a primer. Firstly, public and private keys come in pairs. For a given private key it&#39;s easy to figure out the corresponding public key, <strong>but the opposite is not true</strong>. It&#39;s practically impossible to figure out what the private key corresponding to a given public key is; which is why they&#39;re called <em>public</em> and <em>private</em>: the former is safe to share without compromising the security of the exchange. With a private key, you can encrypt information, in a way, such that only the people who have your public key can read it. By contrast, you cannot encrypt anything with a public key. When we say signed we really mean <em>attached a known piece of data encrypted with the <strong>appropriate</strong> private key</em>. This known piece of data is usually the hash of the entire message, otherwise people could copy the signature to a different message. When something is <em>signed</em>, everyone can read it. Some people: the ones who have your public key, can also tell if the message was written by someone who has your private key. They can&#39;t tell if it&#39;s <em>you</em>, someone who <em>cracked</em> your public key with brute force, or someone who <em>got</em> it from you via social engineering, for example if you leaked your private key in some online conversation. Cracking someone&#39;s key is always possible in theory, but not always practical. For keys shorter than SHA256 it&#39;s quite possible that someone <em>could</em> crack your private key. The best solution is to use a longer key. Usually it makes a tiny file slightly larger, and computations that takes a few microseconds take a few microseconds longer. You can barely notice the difference, at the same time it takes exponentially longer to crack. The only reason not to go with the longest possible key is if your hardware can&#39;t cope with it. Protecting against social engineering isn&#39;t hard, as long as you keep your guard up. In essence, all you need to do is to keep your private key <em>private</em>. Don&#39;t send it to anyone. Don&#39;t use cloud services to move it across devices. Don&#39;t have malware on your computer. Most importantly, don&#39;t use someone else&#39;s private key. Consequently, when you&#39;re deploying your own network, please do <strong>change the keys</strong>. To get new key-pairs, use the <code>iroha_crypto_cli</code> program,</p><div class="language-bash"><pre class="shiki shiki-light" style="background-color:#ffffff;"><code><span class="line"><span style="color:#24292F;">cargo build -p iroha_crypto_cli</span></span>
<span class="line"><span style="color:#24292F;">./target/debug/iroha_crypto_cli</span></span>
<span class="line"></span></code></pre></div><p>which will print a fresh key pair on demand. If you want to set up your own network, you should change the keys for all your peers: in <code>peer/config.json</code> change <code>PUBLIC_KEY</code> and <code>PRIVATE_KEY</code>, to the fresh pair. When you&#39;ve done that, you should add the keys to the <code>TRUSTED_PEERS</code> array in the same configuration file. <strong>EXAMPLE:</strong> in the minimum viable BFT network, you have four peers, so that means that you need to create <em>four</em> different peer configuration files (<code>config.json</code>). Each peer should have its own <code>PUBLIC_KEY</code> and <code>PRIVATE_KEY</code> and all four public keys should be added to the <code>TRUSTED_PEERS</code> array (<em>yes including the peer that you&#39;re configuring</em>), and the same <code>TRUSTED_PEERS</code> array must be copied across all four configuration files. Next, you must make sure that the peers agree on the <code>GENESIS_ACCOUNT</code> key pairs.</p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>Don&#39;t worry about the fact that the genesis account&#39;s private key is known to all peers, the genesis account loses all privileges after the first block gets committed.</p></div><p>Finally, while the first client <em>could</em> use the genesis account to register new users, it&#39;s not a great idea for private networks. You should, instead, register a non-genesis account (for example *alice@*wonderland) and <code>unregister</code> the genesis account.</p><div class="warning custom-block"><p class="custom-block-title">NB</p><p><code>iroha_client_cli</code> currently doesn&#39;t support unregister instructions, if you plan on creating a private blockchain, you should consider writing your own client based off of the <code>client</code> Rust crate, or any of the provided client libraries.</p></div><p>Here are the links to the <a href="https://github.com/hyperledger/iroha-python" target="_blank" rel="noopener noreferrer">iroha-python</a>, <a href="https://github.com/hyperledger/iroha-ios" target="_blank" rel="noopener noreferrer">iroha-iOS</a>, <a href="https://github.com/hyperledger/iroha-java" target="_blank" rel="noopener noreferrer">iroha-java</a> and <a href="https://github.com/hyperledger/iroha-javascript" target="_blank" rel="noopener noreferrer">iroha-javascript</a> libraries.</p><p>Finally, let&#39;s talk about how keys are used in the client. Every transaction is signed on behalf of some user, thus every operation requires a key. That doesn&#39;t mean that you need to explicitly provide a key every time. For example, you need to have a user to register a user (<em>just like you need scissors to open a bag with new scissors</em>). But in order to register a user, you must also provide a new public key, so that the network can verify that it&#39;s that trustworthy *mad_hatter@*wonderland, and not some impostor (<em>possibly sent by the red_queen),</em> so there are cases where you need to provide a key explicitly.</p><p>Each time <code>iroha_client_cli</code> asks you to provide a <code>--key</code> argument, it&#39;s probably a good idea to generate a new key-pair.</p><h2 id="running-iroha-on-bare-metal" tabindex="-1">Running Iroha on bare metal <a class="header-anchor" href="#running-iroha-on-bare-metal" aria-hidden="true">#</a></h2><h3 id="pre-requisites" tabindex="-1">Pre-requisites <a class="header-anchor" href="#pre-requisites" aria-hidden="true">#</a></h3><p>Having read most of the appendix, you are now prepared to start Iroha in a more advanced mode. What we are going to do is replicate the set up that we have in the <code>docker compose</code>, except we don’t go through the intermediary of containers, and run Iroha directly. Running iroha on bare metal involves manipulating files and/or environment variables. What follows is an attempt to run Iroha on bare metal, using either of two methods. We shall first focus on the file-based approach, as it is the easiest to get right. We shall then show you how to do the same using environment variables, which can offer a better user experience if done right, but is more error-prone, particularly for exotic systems. First of all, we should note that we have only built the Iroha client so far. To build the peer software you should run</p><div class="language-kotlin"><pre class="shiki shiki-light" style="background-color:#ffffff;"><code><span class="line"><span style="color:#24292F;">cargo build </span><span style="color:#CF222E;">-</span><span style="color:#24292F;">p iroha</span></span>
<span class="line"></span></code></pre></div><p>This will build Iroha in <code>debug</code> mode, containing many more debug-oriented features and very few (if any) compiler optimisations. A debug build is faster to compile, but if you intend to actually deploy Iroha, you should build it in <code>--release</code> mode like so</p><div class="language-kotlin"><pre class="shiki shiki-light" style="background-color:#ffffff;"><code><span class="line"><span style="color:#24292F;">cargo build </span><span style="color:#CF222E;">-</span><span style="color:#24292F;">p iroha </span><span style="color:#CF222E;">--</span><span style="color:#24292F;">release</span></span>
<span class="line"></span></code></pre></div><p>This will take significantly longer, but should produce both a smaller and faster binary, suitable for deployment in the actual blockchains.</p><h3 id="environment-variables-set-up" tabindex="-1">Environment variables: set-up <a class="header-anchor" href="#environment-variables-set-up" aria-hidden="true">#</a></h3><p>Next we want to make sure that we have the right configuration. To do that, it’s a good idea to either copy the contents of the <code>~/Git/iroha/configs/peer/</code> into a new directory, or alternatively to just run all commands from that directory: <code>cd ~/Git/iroha/configs/peer</code>. A third option is to specify the full path to the configuration in an environment variable. For simplicity we shall do the latter:</p><div class="language-bash"><pre class="shiki shiki-light" style="background-color:#ffffff;"><code><span class="line"><span style="color:#0550AE;">cd</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">~</span></span>
<span class="line"><span style="color:#CF222E;">export</span><span style="color:#24292F;"> IROHA2_GENESIS_PATH=</span><span style="color:#0A3069;">&quot;$(pwd)/Git/iroha/configs/peer/genesis.json&quot;</span></span>
<span class="line"><span style="color:#CF222E;">export</span><span style="color:#24292F;"> IROHA2_CONFIG_PATH=</span><span style="color:#0A3069;">&quot;$(pwd)/Git/iroha/configs/peer/config.json&quot;</span></span>
<span class="line"></span></code></pre></div><p>For extra convenience, you could add the Iroha 2 <code>target</code> directory to your <code>PATH</code>. This means that instead of having to specify the full path to the executable <code>iroha</code> you can instead type <code>iroha</code> directly into your command line.</p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>Don’t forget to replace <code>debug</code> with <code>release</code> when you’re ready to deploy in the real world.</p></div><div class="language-bash"><pre class="shiki shiki-light" style="background-color:#ffffff;"><code><span class="line"><span style="color:#CF222E;">export</span><span style="color:#24292F;"> PATH=</span><span style="color:#0A3069;">&quot;</span><span style="color:#24292F;">$PATH</span><span style="color:#0A3069;">:$(pwd)/Git/iroha/target/debug&quot;</span></span>
<span class="line"></span></code></pre></div><p>This way you can run <code>iroha</code> from any directory, without having to worry about configuration paths and/or specifying the full path to the Iroha executable.</p><p>The instructions here should probably be made permanent, which you can do by adding the following environment variables to your startup shell. On older Linux systems, you copy and paste everything except <code>cd ~</code> to <code>~/.bashrc</code>. On macs running Mac OS X 10.6 and later, as well as some Linux systems, you want to add the same lines to <code>~/.zshrc</code>.</p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>This process is almost universally unreliable and messy, and it’s likely that your system is special in that it breaks some of our assumptions. If the above optional steps didn’t work for you, you can keep working in the <code>~/Git/iroha/configs/peer/</code> folder, and run iroha by doing <code>~/Git/iroha/target/debug/iroha</code>. This makes the command-line a little harder to read, which is why we recommend settin up your environment first.</p></div><div class="info custom-block"><p class="custom-block-title">Note</p><p>The tutorial assumes that you’re running either Linux, Mac OS X, or Windows using WSL. It should be possible to run directly on Windows, but that is neither recommended nor easy. If you don’t want to use a Unix-like system, we suggest that you wait until we publish a detailed guide for Windows users.</p></div><h3 id="files-set-up" tabindex="-1">Files: set-up <a class="header-anchor" href="#files-set-up" aria-hidden="true">#</a></h3><p>This is the recommended method of bringing up an Iroha peer. What we do is create a new directory for the configuration files,</p><div class="language-bash"><pre class="shiki shiki-light" style="background-color:#ffffff;"><code><span class="line"><span style="color:#24292F;">mkdir -p </span><span style="color:#CF222E;">~</span><span style="color:#24292F;">/Git/iroha/deploy</span></span>
<span class="line"></span></code></pre></div><p>and copy the <code>peer</code> configuration into it.</p><div class="language-bash"><pre class="shiki shiki-light" style="background-color:#ffffff;"><code><span class="line"><span style="color:#24292F;">cp -vfr </span><span style="color:#CF222E;">~</span><span style="color:#24292F;">/Git/iroha/configs/peer/</span><span style="color:#CF222E;">*</span><span style="color:#24292F;">.json </span><span style="color:#CF222E;">~</span><span style="color:#24292F;">/Git/iroha/deploy</span></span>
<span class="line"></span></code></pre></div><p>also we copy the respective iroha binary into your binary folder</p><div class="language-bash"><pre class="shiki shiki-light" style="background-color:#ffffff;"><code><span class="line"><span style="color:#24292F;">sudo cp -vfr </span><span style="color:#CF222E;">~</span><span style="color:#24292F;">/Git/iroha/target/debug/iroha /usr/bin/</span></span>
<span class="line"></span></code></pre></div><p>which will install Iroha 2 system wide.</p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>You could also use the iroha peer binary locally, by copying it into the same folder. The only difference would be that you’d be calling Iroha like so: <code>./iroha</code> instead of <code>iroha</code>.</p></div><h3 id="first-run-of-iroha-on-bare-metal" tabindex="-1">First run of Iroha on bare metal <a class="header-anchor" href="#first-run-of-iroha-on-bare-metal" aria-hidden="true">#</a></h3><p>If you’ve done everything correctly, you can now do</p><div class="language-bash"><pre class="shiki shiki-light" style="background-color:#ffffff;"><code><span class="line"><span style="color:#24292F;">iroha</span></span>
<span class="line"></span></code></pre></div><p>to start your first peer and be greeted with</p><p><img src="/iroha-2-docs/assets/appendix_running-iroha_cli-output.159236c6.png" alt=""></p><p>This means that everything is working, but also that we need to do some more work. You have just started a single peer, which can tolerate exactly 0 faults. Running two peers is also possible, but again, can tolerate 0 faults. You must run at least 4 peers in order to have the capacity to tolerate at least one fault. In general, if you want to be resistant to <code>f</code> faults, you want to have <code>3f+1</code> peers: (4, 7, 10 etc.). You can’t really start them in any way you want, though. When we started our original peer, in its configuration, we specified that it has to trust very specific peers, which have the given private key and listen on a specific address. In order to know how to run them appropriately, take a look at <code>docker-compose.yml</code>.</p><details class="details custom-block"><summary>docker-compose.yaml</summary><div class="language-yaml"><pre class="shiki shiki-light" style="background-color:#ffffff;"><code><span class="line"><span style="color:#116329;">version</span><span style="color:#24292F;">: </span><span style="color:#0A3069;">&#39;3.3&#39;</span></span>
<span class="line"><span style="color:#116329;">services</span><span style="color:#24292F;">:</span></span>
<span class="line"><span style="color:#24292F;">  </span><span style="color:#116329;">iroha0</span><span style="color:#24292F;">:</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#116329;">image</span><span style="color:#24292F;">: </span><span style="color:#0A3069;">hyperledger/iroha2:dev</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#116329;">environment</span><span style="color:#24292F;">:</span></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#116329;">TORII_P2P_ADDR</span><span style="color:#24292F;">: </span><span style="color:#0A3069;">iroha0:1337</span></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#116329;">TORII_API_URL</span><span style="color:#24292F;">: </span><span style="color:#0A3069;">iroha0:8080</span></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#116329;">TORII_STATUS_URL</span><span style="color:#24292F;">: </span><span style="color:#0A3069;">iroha0:8180</span></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#116329;">IROHA_PUBLIC_KEY</span><span style="color:#24292F;">: </span><span style="color:#0A3069;">&#39;ed01207233bfc89dcbd68c19fde6ce6158225298ec1131b6a130d1aeb454c1ab5183c0&#39;</span></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#116329;">IROHA_PRIVATE_KEY</span><span style="color:#24292F;">: </span><span style="color:#0A3069;">&#39;{&quot;digest_function&quot;: &quot;ed25519&quot;, &quot;payload&quot;: &quot;9ac47abf59b356e0bd7dcbbbb4dec080e302156a48ca907e47cb6aea1d32719e7233bfc89dcbd68c19fde6ce6158225298ec1131b6a130d1aeb454c1ab5183c0&quot;}&#39;</span></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#116329;">SUMERAGI_TRUSTED_PEERS</span><span style="color:#24292F;">: </span><span style="color:#0A3069;">&#39;[{&quot;address&quot;:&quot;iroha0:1337&quot;, &quot;public_key&quot;: &quot;ed01207233bfc89dcbd68c19fde6ce6158225298ec1131b6a130d1aeb454c1ab5183c0&quot;}, {&quot;address&quot;:&quot;iroha1:1338&quot;, &quot;public_key&quot;: &quot;ed0120cc25624d62896d3a0bfd8940f928dc2abf27cc57cefeb442aa96d9081aae58a1&quot;}, {&quot;address&quot;: &quot;iroha2:1339&quot;, &quot;public_key&quot;: &quot;ed0120faca9e8aa83225cb4d16d67f27dd4f93fc30ffa11adc1f5c88fd5495ecc91020&quot;}, {&quot;address&quot;: &quot;iroha3:1340&quot;, &quot;public_key&quot;: &quot;ed01208e351a70b6a603ed285d666b8d689b680865913ba03ce29fb7d13a166c4e7f1f&quot;}]&#39;</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#116329;">ports</span><span style="color:#24292F;">:</span></span>
<span class="line"><span style="color:#24292F;">      - </span><span style="color:#0A3069;">&#39;1337:1337&#39;</span></span>
<span class="line"><span style="color:#24292F;">      - </span><span style="color:#0A3069;">&#39;8080:8080&#39;</span></span>
<span class="line"><span style="color:#24292F;">      - </span><span style="color:#0A3069;">&#39;8180:8180&#39;</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#116329;">command</span><span style="color:#24292F;">: </span><span style="color:#0A3069;">./iroha --submit-genesis</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292F;">  </span><span style="color:#116329;">iroha1</span><span style="color:#24292F;">:</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#116329;">image</span><span style="color:#24292F;">: </span><span style="color:#0A3069;">hyperledger/iroha2:dev</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#116329;">environment</span><span style="color:#24292F;">:</span></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#116329;">TORII_P2P_ADDR</span><span style="color:#24292F;">: </span><span style="color:#0A3069;">iroha1:1338</span></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#116329;">TORII_API_URL</span><span style="color:#24292F;">: </span><span style="color:#0A3069;">iroha1:8081</span></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#116329;">TORII_STATUS_URL</span><span style="color:#24292F;">: </span><span style="color:#0A3069;">iroha1:8181</span></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#116329;">IROHA_PUBLIC_KEY</span><span style="color:#24292F;">: </span><span style="color:#0A3069;">&#39;ed0120cc25624d62896d3a0bfd8940f928dc2abf27cc57cefeb442aa96d9081aae58a1&#39;</span></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#116329;">IROHA_PRIVATE_KEY</span><span style="color:#24292F;">: </span><span style="color:#0A3069;">&#39;{&quot;digest_function&quot;: &quot;ed25519&quot;, &quot;payload&quot;: &quot;3bac34cda9e3763fa069c1198312d1ec73b53023b8180c822ac355435edc4a24cc25624d62896d3a0bfd8940f928dc2abf27cc57cefeb442aa96d9081aae58a1&quot;}&#39;</span></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#116329;">SUMERAGI_TRUSTED_PEERS</span><span style="color:#24292F;">: </span><span style="color:#0A3069;">&#39;[{&quot;address&quot;:&quot;iroha0:1337&quot;, &quot;public_key&quot;: &quot;ed01207233bfc89dcbd68c19fde6ce6158225298ec1131b6a130d1aeb454c1ab5183c0&quot;}, {&quot;address&quot;:&quot;iroha1:1338&quot;, &quot;public_key&quot;: &quot;ed0120cc25624d62896d3a0bfd8940f928dc2abf27cc57cefeb442aa96d9081aae58a1&quot;}, {&quot;address&quot;: &quot;iroha2:1339&quot;, &quot;public_key&quot;: &quot;ed0120faca9e8aa83225cb4d16d67f27dd4f93fc30ffa11adc1f5c88fd5495ecc91020&quot;}, {&quot;address&quot;: &quot;iroha3:1340&quot;, &quot;public_key&quot;: &quot;ed01208e351a70b6a603ed285d666b8d689b680865913ba03ce29fb7d13a166c4e7f1f&quot;}]&#39;</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#116329;">ports</span><span style="color:#24292F;">:</span></span>
<span class="line"><span style="color:#24292F;">      - </span><span style="color:#0A3069;">&#39;1338:1338&#39;</span></span>
<span class="line"><span style="color:#24292F;">      - </span><span style="color:#0A3069;">&#39;8081:8081&#39;</span></span>
<span class="line"><span style="color:#24292F;">      - </span><span style="color:#0A3069;">&#39;8181:8181&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292F;">  </span><span style="color:#116329;">iroha2</span><span style="color:#24292F;">:</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#116329;">image</span><span style="color:#24292F;">: </span><span style="color:#0A3069;">hyperledger/iroha2:dev</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#116329;">environment</span><span style="color:#24292F;">:</span></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#116329;">TORII_P2P_ADDR</span><span style="color:#24292F;">: </span><span style="color:#0A3069;">iroha2:1339</span></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#116329;">TORII_API_URL</span><span style="color:#24292F;">: </span><span style="color:#0A3069;">iroha2:8082</span></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#116329;">TORII_STATUS_URL</span><span style="color:#24292F;">: </span><span style="color:#0A3069;">iroha2:8182</span></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#116329;">IROHA_PUBLIC_KEY</span><span style="color:#24292F;">: </span><span style="color:#0A3069;">&#39;ed0120faca9e8aa83225cb4d16d67f27dd4f93fc30ffa11adc1f5c88fd5495ecc91020&#39;</span></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#116329;">IROHA_PRIVATE_KEY</span><span style="color:#24292F;">: </span><span style="color:#0A3069;">&#39;{&quot;digest_function&quot;: &quot;ed25519&quot;, &quot;payload&quot;: &quot;1261a436d36779223d7d6cf20e8b644510e488e6a50bafd77a7485264d27197dfaca9e8aa83225cb4d16d67f27dd4f93fc30ffa11adc1f5c88fd5495ecc91020&quot;}&#39;</span></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#116329;">SUMERAGI_TRUSTED_PEERS</span><span style="color:#24292F;">: </span><span style="color:#0A3069;">&#39;[{&quot;address&quot;:&quot;iroha0:1337&quot;, &quot;public_key&quot;: &quot;ed01207233bfc89dcbd68c19fde6ce6158225298ec1131b6a130d1aeb454c1ab5183c0&quot;}, {&quot;address&quot;:&quot;iroha1:1338&quot;, &quot;public_key&quot;: &quot;ed0120cc25624d62896d3a0bfd8940f928dc2abf27cc57cefeb442aa96d9081aae58a1&quot;}, {&quot;address&quot;: &quot;iroha2:1339&quot;, &quot;public_key&quot;: &quot;ed0120faca9e8aa83225cb4d16d67f27dd4f93fc30ffa11adc1f5c88fd5495ecc91020&quot;}, {&quot;address&quot;: &quot;iroha3:1340&quot;, &quot;public_key&quot;: &quot;ed01208e351a70b6a603ed285d666b8d689b680865913ba03ce29fb7d13a166c4e7f1f&quot;}]&#39;</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#116329;">ports</span><span style="color:#24292F;">:</span></span>
<span class="line"><span style="color:#24292F;">      - </span><span style="color:#0A3069;">&#39;1339:1339&#39;</span></span>
<span class="line"><span style="color:#24292F;">      - </span><span style="color:#0A3069;">&#39;8082:8082&#39;</span></span>
<span class="line"><span style="color:#24292F;">      - </span><span style="color:#0A3069;">&#39;8182:8182&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292F;">  </span><span style="color:#116329;">iroha3</span><span style="color:#24292F;">:</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#116329;">image</span><span style="color:#24292F;">: </span><span style="color:#0A3069;">hyperledger/iroha2:dev</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#116329;">environment</span><span style="color:#24292F;">:</span></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#116329;">TORII_P2P_ADDR</span><span style="color:#24292F;">: </span><span style="color:#0A3069;">iroha3:1340</span></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#116329;">TORII_API_URL</span><span style="color:#24292F;">: </span><span style="color:#0A3069;">iroha3:8083</span></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#116329;">TORII_STATUS_URL</span><span style="color:#24292F;">: </span><span style="color:#0A3069;">iroha3:8183</span></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#116329;">IROHA_PUBLIC_KEY</span><span style="color:#24292F;">: </span><span style="color:#0A3069;">&#39;ed01208e351a70b6a603ed285d666b8d689b680865913ba03ce29fb7d13a166c4e7f1f&#39;</span></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#116329;">IROHA_PRIVATE_KEY</span><span style="color:#24292F;">: </span><span style="color:#0A3069;">&#39;{&quot;digest_function&quot;: &quot;ed25519&quot;, &quot;payload&quot;: &quot;a70dab95c7482eb9f159111b65947e482108cfe67df877bd8d3b9441a781c7c98e351a70b6a603ed285d666b8d689b680865913ba03ce29fb7d13a166c4e7f1f&quot;}&#39;</span></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#116329;">SUMERAGI_TRUSTED_PEERS</span><span style="color:#24292F;">: </span><span style="color:#0A3069;">&#39;[{&quot;address&quot;:&quot;iroha0:1337&quot;, &quot;public_key&quot;: &quot;ed01207233bfc89dcbd68c19fde6ce6158225298ec1131b6a130d1aeb454c1ab5183c0&quot;}, {&quot;address&quot;:&quot;iroha1:1338&quot;, &quot;public_key&quot;: &quot;ed0120cc25624d62896d3a0bfd8940f928dc2abf27cc57cefeb442aa96d9081aae58a1&quot;}, {&quot;address&quot;: &quot;iroha2:1339&quot;, &quot;public_key&quot;: &quot;ed0120faca9e8aa83225cb4d16d67f27dd4f93fc30ffa11adc1f5c88fd5495ecc91020&quot;}, {&quot;address&quot;: &quot;iroha3:1340&quot;, &quot;public_key&quot;: &quot;ed01208e351a70b6a603ed285d666b8d689b680865913ba03ce29fb7d13a166c4e7f1f&quot;}]&#39;</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#116329;">ports</span><span style="color:#24292F;">:</span></span>
<span class="line"><span style="color:#24292F;">      - </span><span style="color:#0A3069;">&#39;1340:1340&#39;</span></span>
<span class="line"><span style="color:#24292F;">      - </span><span style="color:#0A3069;">&#39;8083:8083&#39;</span></span>
<span class="line"><span style="color:#24292F;">      - </span><span style="color:#0A3069;">&#39;8183:8183&#39;</span></span>
<span class="line"></span></code></pre></div></details><p>For every peer, the <code>environment</code> section is the set of things that you should put in front of the <code>iroha</code> command, replacing colons with equals signs. All the socket addresses are also given internal to the docker network, so we should replace them with <code>[localhost](http://localhost)</code> which is <code>127.0.0.1</code> on most machines.</p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>Each Iroha instance is going to listen on three ports: the Peer-to-peer communications channel (<code>133X</code>), the API url, where most client requests are posted (<code>808X</code>), and finally, a telemetry endpoint <code>818X</code>. All three ports need to be adjusted so there are no collisions. See the <code>docker-compose.yml</code> for an example, and adjust as needed.</p></div><h3 id="environment-variables-deploy-a-minimal-bft-network" tabindex="-1">Environment Variables: deploy a minimal BFT network <a class="header-anchor" href="#environment-variables-deploy-a-minimal-bft-network" aria-hidden="true">#</a></h3><p>So to run the First peer, we need to write</p><div class="language-bash"><pre class="shiki shiki-light" style="background-color:#ffffff;"><code><span class="line"><span style="color:#24292F;">TORII_P2P_ADDR=</span><span style="color:#0A3069;">&quot;127.0.0.1:1337&quot;</span></span>
<span class="line"><span style="color:#24292F;">TORII_API_URL=</span><span style="color:#0A3069;">&quot;127.0.0.1:8080&quot;</span></span>
<span class="line"><span style="color:#24292F;">TORII_STATUS_URL=</span><span style="color:#0A3069;">&quot;127.0.0.1:8180&quot;</span></span>
<span class="line"><span style="color:#24292F;">IROHA_PUBLIC_KEY=</span><span style="color:#0A3069;">&quot;ed01207233bfc89dcbd68c19fde6ce6158225298ec1131b6a130d1aeb454c1ab5183c0&quot;</span><span style="color:#24292F;"> IROHA_PRIVATE_KEY=</span><span style="color:#0A3069;">&#39;{&quot;digest_function&quot;: &quot;ed25519&quot;, &quot;payload&quot;: &quot;9ac47abf59b356e0bd7dcbbbb4dec080e302156a48ca907e47cb6aea1d32719e7233bfc89dcbd68c19fde6ce6158225298ec1131b6a130d1aeb454c1ab5183c0&quot;}&#39;</span></span>
<span class="line"><span style="color:#24292F;">iroha --submit</span></span>
<span class="line"></span></code></pre></div><p>and three other similar lines of bash for the remaining deployments.</p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>To copy and paste into the terminal on Linux systems, you should remember that <code>Control + **shift** + V</code> is the appropriate <code>paste</code> shortcut.</p></div><p>Also note that we asked this peer to <code>--submit</code> or <code>--submit-genesis</code>. This means that in the initial network topology, this peer is the leader. At least one peer (usually the first) needs to be the leader in the initial topology.</p><p>Now you should do the same for the other four peers. Be mindful not to mix up which address goes which, replace <code>irohaX</code> with <code>127.0.0.1</code> in the addresses, and make sure that they correspond to the right public key.</p><p>This is messy, and error-prone, which is why the tutorial uses <code>docker-compose</code>. However, this brings you closer to the experience of actually maintaining a functional Iroha peer.</p><h3 id="files-deploy-a-minimal-bft-network" tabindex="-1">Files: deploy a minimal BFT network <a class="header-anchor" href="#files-deploy-a-minimal-bft-network" aria-hidden="true">#</a></h3><p>Our first peer can run off of the original configuration file. What we should do is create three more similar files and move them to three different folders e.g. <code>peer1</code>, <code>peer2</code>. What you need to do is change the <code>TORII:P2P_ADDR</code>, <code>TORII:API_URL</code> <code>TORII:STATUS_URL</code> and the <code>PUBLIC_KEY</code> configuration options to align with their <code>docker-compose.yml</code> counterparts. Then in each of the new folders (<code>peer1</code>, <code>peer2</code> etc.) run:</p><div class="language-bash"><pre class="shiki shiki-light" style="background-color:#ffffff;"><code><span class="line"><span style="color:#24292F;">iroha</span></span>
<span class="line"></span></code></pre></div><p>except for one. In the first folder <code>peer0</code> you should instead run</p><div class="language-bash"><pre class="shiki shiki-light" style="background-color:#ffffff;"><code><span class="line"><span style="color:#24292F;">iroha --submit-genesis</span></span>
<span class="line"></span></code></pre></div><p>We effectively asked this peer to <code>--submit</code> or <code>--submit-genesis</code> in the initial or <em>bootstrap</em> network. This means that in the initial network topology, this peer is the leader.</p><div class="info custom-block"><p class="custom-block-title">Note</p><p>Only the leader of the genesis network needs to have access to <code>genesis.json</code>. Having the same genesis in the initial folders of the other peers could be useful, since future versions of <code>iroha</code> will also sanity-check the genesis blocks.</p><p>Now you should do the same for the other four peers. Be mindful not to mix up which address goes which, replace <code>irohaX</code> with <code>127.0.0.1</code> in the addresses, and make sure that they correspond to the right public key.</p><p>This is messy, and error-prone, which is why the tutorial uses <code>docker-compose</code>. However, this brings you closer to the experience of actually maintaining a functional Iroha peer.</p><p>If all went well, you should be greeted with nice logs on each of the nodes, and the nodes should commit the blocks to the <code>blocks/</code> directory.</p><h3 id="real-world-deployment" tabindex="-1">Real-world deployment <a class="header-anchor" href="#real-world-deployment" aria-hidden="true">#</a></h3><p>Suppose now, that you have done all of the tinkering and want to deploy Iroha in the real world. Firstly, you should build it in release mode:</p><div class="language-bash"><pre class="shiki shiki-light" style="background-color:#ffffff;"><code><span class="line"><span style="color:#24292F;">cargo build --release</span></span>
<span class="line"></span></code></pre></div><p>Secondly, you want to generate a key pair for your peer:</p><div class="language-bash"><pre class="shiki shiki-light" style="background-color:#ffffff;"><code><span class="line"><span style="color:#24292F;">cargo run --bin iroha_crypto_cli</span></span>
<span class="line"></span></code></pre></div><p>And take not of that key. Thirdly, you should register your peer to a network, and make sure to add at least four of the peers on that network to the <code>TRUSTED_PEERS</code> array in your configuration file. You then determine the web socket that the other peers will use to connect to you. Make sure that the port is open and use that Address in your <code>config.json</code>. Finally, after you finished editing the configuration file iroha is deployed by running</p><div class="language-bash"><pre class="shiki shiki-light" style="background-color:#ffffff;"><code><span class="line"><span style="color:#CF222E;">~</span><span style="color:#24292F;">/Git/iroha/target/release/iroha</span></span>
<span class="line"></span></code></pre></div><div class="info custom-block"><p class="custom-block-title">Note</p><p>There’s no need to pass the <code>--submit</code> flag, unless you are starting the initial peer on the network.</p></div></div></div></div><footer class="page-footer" data-v-5ab2b583 data-v-c710f5fe><div class="edit" data-v-c710f5fe><div class="edit-link" data-v-c710f5fe data-v-dc147d58><a class="link" href="https://github.com/hyperledger/iroha-2-docs/edit/master/src/guide/appendix.md" target="_blank" rel="noopener noreferrer" data-v-dc147d58>Edit this page <svg class="icon outbound icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-dc147d58><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div><div class="updated" data-v-c710f5fe><p class="last-updated" data-v-c710f5fe data-v-ae38ef34><span class="prefix" data-v-ae38ef34>Last Updated:</span><span class="datetime" data-v-ae38ef34></span></p></div></footer><!----><!--[--><!--]--></div></main></div><!----><!--]--></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"api_index.md\":\"b9fb2d72\",\"guide_appendix.md\":\"b560ba6c\",\"guide_appendix_client-configuration.md\":\"334648fb\",\"guide_appendix_genesis.md\":\"bd69e44d\",\"guide_appendix_intro.md\":\"33914db7\",\"guide_appendix_keys.md\":\"0909bf9a\",\"guide_appendix_kura.md\":\"ee69c26e\",\"guide_appendix_logger.md\":\"8ebe1eba\",\"guide_appendix_peer-configuration.md\":\"b592d933\",\"guide_appendix_public-addresses.md\":\"55133da6\",\"guide_appendix_running-iroha-on-bare-metal.md\":\"e15fb1f8\",\"guide_appendix_trusted-peers.md\":\"305e54d8\",\"guide_bash.md\":\"cb5e50a6\",\"guide_build-and-install.md\":\"4c4acfe8\",\"guide_conclusions.md\":\"804301c5\",\"guide_javascript.md\":\"aca015ee\",\"guide_kotlin-java.md\":\"812cfc64\",\"guide_python.md\":\"11da7590\",\"guide_rust.md\":\"c70ff810\",\"index.md\":\"8bf40a12\"}")</script>
    <script type="module" async src="/iroha-2-docs/assets/app.5cbb4beb.js"></script>
    
  </body>
</html>